{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/Pascal%20Digny/Github%20Lab/Kabinda%20Lodge%202.0/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-4 sm:p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h3\n    ref={ref}\n    className={cn(\n      \"text-lg sm:text-xl lg:text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <p\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-4 pt-0 sm:p-6\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-4 pt-0 sm:p-6\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n"],"names":[],"mappings":";;;;;;;;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,qBAAO,2KAAgB,MAG3B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,4DACA;QAED,GAAG,KAAK;;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,2KAAgB,OAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,wCAAwC;QACrD,GAAG,KAAK;;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,2KAAgB,OAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,4EACA;QAED,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,2KAAgB,OAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QAAI,KAAK;QAAK,WAAW,IAAA,4HAAE,EAAC,mBAAmB;QAAa,GAAG,KAAK;;;;;;;AAEvE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,2KAAgB,QAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,qCAAqC;QAClD,GAAG,KAAK;;;;;;;AAGb,WAAW,WAAW,GAAG"}},
    {"offset": {"line": 111, "column": 0}, "map": {"version":3,"sources":["file:///Users/Pascal%20Digny/Github%20Lab/Kabinda%20Lodge%202.0/src/components/ui/input.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;AAEA,MAAM,sBAAQ,2KAAgB,MAC5B,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAO,EAAE;IAC9B,qBACE,6LAAC;QACC,MAAM;QACN,WAAW,IAAA,4HAAE,EACX,kYACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,MAAM,WAAW,GAAG"}},
    {"offset": {"line": 146, "column": 0}, "map": {"version":3,"sources":["file:///Users/Pascal%20Digny/Github%20Lab/Kabinda%20Lodge%202.0/src/components/ui/label.tsx"],"sourcesContent":["import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAEA;;;;;;AAEA,MAAM,gBAAgB,IAAA,0KAAG,EACvB;AAGF,MAAM,sBAAQ,2KAAgB,MAI5B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,4KAAmB;QAClB,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,iBAAiB;QAC9B,GAAG,KAAK;;;;;;;AAGb,MAAM,WAAW,GAAG,4KAAmB,CAAC,WAAW"}},
    {"offset": {"line": 183, "column": 0}, "map": {"version":3,"sources":["file:///Users/Pascal%20Digny/Github%20Lab/Kabinda%20Lodge%202.0/src/components/ui/textarea.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nexport interface TextareaProps\n  extends React.TextareaHTMLAttributes<HTMLTextAreaElement> {\n  children?: React.ReactNode;\n}\n\nconst Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(\n  ({ className, ...props }, ref) => {\n    return (\n      <textarea\n        className={cn(\n          \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n"],"names":[],"mappings":";;;;;AAAA;AAEA;;;;AAOA,MAAM,yBAAW,2KAAgB,MAC/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE;IACxB,qBACE,6LAAC;QACC,WAAW,IAAA,4HAAE,EACX,wSACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,SAAS,WAAW,GAAG"}},
    {"offset": {"line": 217, "column": 0}, "map": {"version":3,"sources":["file:///Users/Pascal%20Digny/Github%20Lab/Kabinda%20Lodge%202.0/src/components/ui/badge.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AAEA;;;;AAEA,MAAM,gBAAgB,IAAA,0KAAG,EACvB,0KACA;IACE,UAAU;QACR,SAAS;YACP,SACE;YACF,WACE;YACF,aACE;YACF,SAAS;QACX;IACF;IACA,iBAAiB;QACf,SAAS;IACX;AACF;AAOF,SAAS,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,OAAmB;IACzD,qBACE,6LAAC;QAAI,WAAW,IAAA,4HAAE,EAAC,cAAc;YAAE;QAAQ,IAAI;QAAa,GAAG,KAAK;;;;;;AAExE;KAJS"}},
    {"offset": {"line": 265, "column": 0}, "map": {"version":3,"sources":["file:///Users/Pascal%20Digny/Github%20Lab/Kabinda%20Lodge%202.0/src/components/ReceiptGenerator.tsx"],"sourcesContent":["import React, { useRef } from 'react';\nimport { Download, Printer } from 'lucide-react';\nimport jsPDF from 'jspdf';\nimport html2canvas from 'html2canvas';\n\n// --- Helper Functions ---\n\nconst formatCurrency = (amount: number) => `$${amount.toFixed(2)}`;\n\nconst formatDate = (dateString: string | undefined) => {\n  if (!dateString) return \"-\";\n  const date = new Date(dateString);\n  return new Intl.DateTimeFormat('en-US', { \n    month: 'long', \n    day: 'numeric', \n    year: 'numeric' \n  }).format(date);\n};\n\nconst formatInvoiceNumber = (id: number) => `KL-${id.toString().padStart(6, '0')}`;\n\n// --- Type Definition ---\ninterface ReceiptData {\n  bookingId: number;\n  guestName: string;\n  guestEmail?: string;\n  guestPhone?: string;\n  guestCompany?: string;\n  guestIdType?: string;\n  guestIdNumber?: string;\n  roomName: string;\n  roomType: string;\n  checkIn: string;\n  checkOut: string;\n  nights?: number;\n  days?: number;\n  roomPrice: number;\n  totalAmount: number;\n  paymentMethod: string;\n  transactionRef?: string;\n  bookingType?: 'hotel' | 'conference';\n  createdAt: string;\n  promotion?: {\n    title: string;\n    description: string;\n    discount_percent: number;\n    discount_type?: 'percentage' | 'fixed';\n    discount_amount?: number;\n    promotion_type?: 'general' | 'partner';\n  };\n}\n\ninterface InvoiceProps {\n  receiptData: ReceiptData;\n  onClose?: () => void;\n}\n\n// --- PDF Generation Function ---\nconst generatePDF = async (previewRef: React.RefObject<HTMLDivElement>) => {\n  if (!previewRef.current) {\n    console.error('Preview element not found');\n    return;\n  }\n\n  try {\n    // Configure html2canvas to capture exactly like it looks\n    const canvas = await html2canvas(previewRef.current, {\n      scale: 2, // Higher resolution for better quality\n      useCORS: true,\n      allowTaint: true,\n      backgroundColor: '#ffffff',\n      width: previewRef.current.offsetWidth,\n      height: previewRef.current.offsetHeight,\n      logging: false,\n      imageTimeout: 0,\n      removeContainer: true,\n    });\n\n    // Create PDF with A4 dimensions\n    const pdf = new jsPDF('p', 'mm', 'a4');\n    const pdfWidth = pdf.internal.pageSize.getWidth();\n    const pdfHeight = pdf.internal.pageSize.getHeight();\n\n    // Calculate dimensions to fit the canvas in the PDF\n    const canvasWidth = canvas.width;\n    const canvasHeight = canvas.height;\n    const canvasAspectRatio = canvasWidth / canvasHeight;\n\n    // Fill the page with minimal margins\n    const margin = 0;\n    const finalWidth = pdfWidth;\n    const finalHeight = pdfHeight;\n\n    // Convert canvas to base64 and add to PDF\n    const imgData = canvas.toDataURL('image/png');\n    pdf.addImage(imgData, 'PNG', 0, 0, finalWidth, finalHeight);\n\n    // Generate filename\n    const data = previewRef.current?.dataset?.receiptData;\n    let invoiceNum = 'unknown';\n    if (data) {\n      try {\n        const parsedData = JSON.parse(data);\n        invoiceNum = formatInvoiceNumber(parsedData.bookingId || 'unknown');\n      } catch (e) {\n        console.warn('Could not parse receipt data for filename');\n      }\n    }\n    const fileName = `Receipt_${invoiceNum}_${new Date().toISOString().split('T')[0]}.pdf`;\n\n    // Save the PDF\n    pdf.save(fileName);\n  } catch (error) {\n    console.error('Error generating PDF:', error);\n    // Fallback to basic PDF generation if html2canvas fails\n    console.warn('Falling back to basic PDF generation');\n    // You could implement a fallback here if needed\n  }\n};\n\n// --- Presentational Component (Accepts props) ---\nconst Invoice: React.FC<InvoiceProps> = ({ receiptData, onClose }) => {\n  const previewRef = useRef<HTMLDivElement>(null);\n\n  const handleDownloadPDF = async () => {\n    await generatePDF(previewRef);\n  };\n\n  const handlePrint = async () => {\n    if (!previewRef.current) return;\n    \n    try {\n      // Capture the receipt as an image using html2canvas (same as PDF)\n      const canvas = await html2canvas(previewRef.current, {\n        scale: 2,\n        useCORS: true,\n        allowTaint: true,\n        backgroundColor: '#ffffff',\n        width: previewRef.current.offsetWidth,\n        height: previewRef.current.offsetHeight,\n        logging: false,\n        imageTimeout: 0,\n      });\n\n      // Convert canvas to image data URL\n      const imgData = canvas.toDataURL('image/png');\n      \n      // Open a new window with the image for printing\n      const printWindow = window.open('', '_blank');\n      if (!printWindow) {\n        alert('Please allow popups to print the receipt');\n        return;\n      }\n\n      // Create print-friendly HTML with the captured image\n      const printHTML = `\n        <!DOCTYPE html>\n        <html>\n          <head>\n            <title>Receipt - ${formatInvoiceNumber(receiptData.bookingId)}</title>\n            <style>\n              @media print {\n                @page {\n                  margin: 0;\n                  size: A4;\n                }\n                body {\n                  margin: 0;\n                  padding: 0;\n                }\n                img {\n                  width: 100%;\n                  height: auto;\n                  page-break-inside: avoid;\n                }\n              }\n              body {\n                margin: 0;\n                padding: 0;\n                display: flex;\n                justify-content: center;\n                align-items: center;\n                min-height: 100vh;\n                background: white;\n              }\n              img {\n                max-width: 100%;\n                height: auto;\n                display: block;\n              }\n            </style>\n          </head>\n          <body>\n            <img src=\"${imgData}\" alt=\"Receipt\" />\n            <script>\n              window.onload = function() {\n                setTimeout(function() {\n                  window.print();\n                }, 250);\n              };\n              window.onafterprint = function() {\n                window.close();\n              };\n            </script>\n          </body>\n        </html>\n      `;\n\n      printWindow.document.write(printHTML);\n      printWindow.document.close();\n    } catch (error) {\n      console.error('Error printing receipt:', error);\n      alert('Failed to print receipt. Please try downloading the PDF instead.');\n    }\n  };\n\n  if (!receiptData) return <div className=\"p-8 text-center text-gray-500\">No invoice data available.</div>;\n\n  return (\n    <div className=\"max-w-3xl mx-auto bg-white shadow-lg rounded-lg p-8\">\n      {/* Action Buttons */}\n      <div className=\"mb-6 flex justify-end gap-3\">\n        <button \n          onClick={handlePrint}\n          className=\"flex items-center gap-2 bg-white border-2 border-slate-800 text-slate-800 px-4 py-2 rounded-lg hover:bg-slate-50 transition-colors shadow-sm\"\n        >\n          <Printer size={18} />\n          Print\n        </button>\n        <button \n          onClick={handleDownloadPDF}\n          className=\"flex items-center gap-2 bg-slate-800 text-white px-4 py-2 rounded-lg hover:bg-slate-700 transition-colors shadow-sm\"\n        >\n          <Download size={18} />\n          Download PDF\n        </button>\n      </div>\n\n      {/* Preview Section */}\n      <div\n        ref={previewRef}\n        className=\"border-2 border-dashed border-gray-300 rounded-lg p-0 bg-white\"\n        data-receipt-data={JSON.stringify(receiptData)}\n      >\n        <div className=\"p-6 text-center mb-6\">\n          <div className=\"flex justify-center mb-4\">\n            <img src=\"/logo.png\" alt=\"Kabinda Lodge Logo\" className=\"h-20 w-20 object-contain\" />\n          </div>\n          <h1 className=\"text-2xl font-bold text-red-900 tracking-wide uppercase mb-1\">Kabinda Lodge</h1>\n          <h2 className=\"text-xs font-bold text-gray-400 tracking-[0.2em] uppercase mb-4\">Facture</h2>\n          \n          <div className=\"flex justify-center gap-8 text-xs\">\n            <div className=\"flex flex-col items-center\">\n              <span className=\"font-bold text-gray-800\">Date de Reçu</span>\n              <span className=\"text-gray-500 font-medium\">{formatDate(receiptData.createdAt)}</span>\n            </div>\n            <div className=\"flex flex-col items-center\">\n              <span className=\"font-bold text-gray-800\">No</span>\n              <span className=\"text-red-800 font-bold\">{formatInvoiceNumber(receiptData.bookingId)}</span>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"px-6 grid grid-cols-1 md:grid-cols-2 gap-6 mb-6\">\n          <div>\n            <h3 className=\"text-xs font-bold text-red-900 uppercase border-b border-red-900 pb-1 mb-2\">\n              Guest Information\n            </h3>\n            <div className=\"space-y-1 text-xs\">\n              <div><span className=\"font-bold text-gray-700\">Nom du Client: </span>{receiptData.guestName}</div>\n              {receiptData.guestPhone && <div><span className=\"font-bold text-gray-700\">Téléphone: </span>{receiptData.guestPhone}</div>}\n              {receiptData.guestCompany && <div><span className=\"font-bold text-gray-700\">Company: </span>{receiptData.guestCompany}</div>}\n              {receiptData.guestIdNumber && <div><span className=\"font-bold text-gray-700\">ID ({receiptData.guestIdType || 'Ref'}): </span>{receiptData.guestIdNumber}</div>}\n            </div>\n          </div>\n\n          <div>\n            <h3 className=\"text-xs font-bold text-red-900 uppercase border-b border-red-900 pb-1 mb-2\">\n              Booking Details\n            </h3>\n            <div className=\"space-y-1 text-xs\">\n              <div><span className=\"font-bold text-gray-700\">Nom de la Chambre: </span>{receiptData.roomName}</div>\n              <div><span className=\"font-bold text-gray-700\">Arrivée: </span>{formatDate(receiptData.checkIn)}</div>\n              <div><span className=\"font-bold text-gray-700\">Départ: </span>{formatDate(receiptData.checkOut)}</div>\n              {(receiptData.nights !== undefined || receiptData.days !== undefined) && (\n                <div><span className=\"font-bold text-gray-700\">{receiptData.days ? 'Jours' : 'Nuits'}: </span>{receiptData.days || receiptData.nights}</div>\n              )}\n              <div><span className=\"font-bold text-gray-700\">Prix de la Chambre: </span>{formatCurrency(receiptData.roomPrice)}</div>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"px-6 mb-4\">\n          <h3 className=\"text-xs font-bold text-red-900 uppercase border-b border-red-900 pb-1 mb-2\">\n            Payment Information\n          </h3>\n          <div className=\"text-xs space-y-1\">\n            <div><span className=\"font-bold text-gray-700\">Méthode de Paiement: </span>{receiptData.paymentMethod}</div>\n            {receiptData.transactionRef && <div><span className=\"font-bold text-gray-700\">Référence Transaction: </span>{receiptData.transactionRef}</div>}\n          </div>\n        </div>\n\n        {receiptData.promotion && (\n          <div className=\"mx-6 bg-orange-50 border border-orange-100 rounded p-2 mb-4 text-xs\">\n            <div className=\"flex justify-between text-orange-800\">\n              <span className=\"font-bold\">{receiptData.promotion.title}</span>\n              <span>-{formatCurrency(receiptData.promotion.discount_amount || 0)}</span>\n            </div>\n          </div>\n        )}\n\n        <div className=\"mx-6 bg-gray-50 rounded p-3 flex justify-end items-center mb-6\">\n          <span className=\"text-xs font-bold text-gray-400 uppercase tracking-wider mr-3\">Montant Total:</span>\n          <span className=\"text-lg font-bold text-gray-800\">{formatCurrency(receiptData.totalAmount)}</span>\n        </div>\n\n        <div className=\"px-6 flex justify-between items-start pt-4 border-t border-dashed border-gray-300\">\n          <div className=\"text-left text-xs text-gray-500 flex-1\">\n            <p className=\"font-bold text-red-900 mb-1\">Merci d'avoir choisi Kabinda Lodge.</p>\n            <p className=\"mb-1\">Nous espérons que vous apprécierez votre séjour !</p>\n            <p className=\"text-[10px]\">Document officiel. © Kabinda Lodge. Tous droits réservés.</p>\n          </div>\n          <div className=\"flex flex-col items-center flex-shrink-0 ml-4\">\n            <div className=\"bg-white p-1 border border-gray-300 rounded\">\n              <img \n                src={`https://api.qrserver.com/v1/create-qr-code/?size=100x100&data=${encodeURIComponent('https://www.google.com/search?q=Kabinda+Lodge+review')}`}\n                alt=\"QR Code\" \n                className=\"w-16 h-16\"\n              />\n            </div>\n            <span className=\"text-[9px] mt-1 font-medium text-gray-400\">Avis Google</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n// --- Modal Wrapper Component ---\nexport const ReceiptGenerator: React.FC<InvoiceProps> = ({ receiptData, onClose }) => {\n  return (\n    <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4\">\n      <div className=\"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[95vh] overflow-y-auto\">\n        <div className=\"p-6 flex justify-between items-center border-b mb-4\">\n          <h2 className=\"text-2xl font-bold\">Receipt</h2>\n          {onClose && (\n            <button\n              onClick={onClose}\n              className=\"text-gray-500 hover:text-gray-700 text-2xl font-bold\"\n            >\n              ×\n            </button>\n          )}\n        </div>\n        <div className=\"px-6 pb-6\">\n          <Invoice receiptData={receiptData} onClose={onClose} />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Invoice;\n"],"names":[],"mappings":";;;;;;;AAAA;AACA;AAAA;AACA;AACA;;;;;;;AAEA,2BAA2B;AAE3B,MAAM,iBAAiB,CAAC,SAAmB,CAAC,CAAC,EAAE,OAAO,OAAO,CAAC,IAAI;AAElE,MAAM,aAAa,CAAC;IAClB,IAAI,CAAC,YAAY,OAAO;IACxB,MAAM,OAAO,IAAI,KAAK;IACtB,OAAO,IAAI,KAAK,cAAc,CAAC,SAAS;QACtC,OAAO;QACP,KAAK;QACL,MAAM;IACR,GAAG,MAAM,CAAC;AACZ;AAEA,MAAM,sBAAsB,CAAC,KAAe,CAAC,GAAG,EAAE,GAAG,QAAQ,GAAG,QAAQ,CAAC,GAAG,MAAM;AAsClF,kCAAkC;AAClC,MAAM,cAAc,OAAO;IACzB,IAAI,CAAC,WAAW,OAAO,EAAE;QACvB,QAAQ,KAAK,CAAC;QACd;IACF;IAEA,IAAI;QACF,yDAAyD;QACzD,MAAM,SAAS,MAAM,IAAA,gKAAW,EAAC,WAAW,OAAO,EAAE;YACnD,OAAO;YACP,SAAS;YACT,YAAY;YACZ,iBAAiB;YACjB,OAAO,WAAW,OAAO,CAAC,WAAW;YACrC,QAAQ,WAAW,OAAO,CAAC,YAAY;YACvC,SAAS;YACT,cAAc;YACd,iBAAiB;QACnB;QAEA,gCAAgC;QAChC,MAAM,MAAM,IAAI,iKAAK,CAAC,KAAK,MAAM;QACjC,MAAM,WAAW,IAAI,QAAQ,CAAC,QAAQ,CAAC,QAAQ;QAC/C,MAAM,YAAY,IAAI,QAAQ,CAAC,QAAQ,CAAC,SAAS;QAEjD,oDAAoD;QACpD,MAAM,cAAc,OAAO,KAAK;QAChC,MAAM,eAAe,OAAO,MAAM;QAClC,MAAM,oBAAoB,cAAc;QAExC,qCAAqC;QACrC,MAAM,SAAS;QACf,MAAM,aAAa;QACnB,MAAM,cAAc;QAEpB,0CAA0C;QAC1C,MAAM,UAAU,OAAO,SAAS,CAAC;QACjC,IAAI,QAAQ,CAAC,SAAS,OAAO,GAAG,GAAG,YAAY;QAE/C,oBAAoB;QACpB,MAAM,OAAO,WAAW,OAAO,EAAE,SAAS;QAC1C,IAAI,aAAa;QACjB,IAAI,MAAM;YACR,IAAI;gBACF,MAAM,aAAa,KAAK,KAAK,CAAC;gBAC9B,aAAa,oBAAoB,WAAW,SAAS,IAAI;YAC3D,EAAE,OAAO,GAAG;gBACV,QAAQ,IAAI,CAAC;YACf;QACF;QACA,MAAM,WAAW,CAAC,QAAQ,EAAE,WAAW,CAAC,EAAE,IAAI,OAAO,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC;QAEtF,eAAe;QACf,IAAI,IAAI,CAAC;IACX,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,wDAAwD;QACxD,QAAQ,IAAI,CAAC;IACb,gDAAgD;IAClD;AACF;AAEA,mDAAmD;AACnD,MAAM,UAAkC,CAAC,EAAE,WAAW,EAAE,OAAO,EAAE;;IAC/D,MAAM,aAAa,IAAA,uKAAM,EAAiB;IAE1C,MAAM,oBAAoB;QACxB,MAAM,YAAY;IACpB;IAEA,MAAM,cAAc;QAClB,IAAI,CAAC,WAAW,OAAO,EAAE;QAEzB,IAAI;YACF,kEAAkE;YAClE,MAAM,SAAS,MAAM,IAAA,gKAAW,EAAC,WAAW,OAAO,EAAE;gBACnD,OAAO;gBACP,SAAS;gBACT,YAAY;gBACZ,iBAAiB;gBACjB,OAAO,WAAW,OAAO,CAAC,WAAW;gBACrC,QAAQ,WAAW,OAAO,CAAC,YAAY;gBACvC,SAAS;gBACT,cAAc;YAChB;YAEA,mCAAmC;YACnC,MAAM,UAAU,OAAO,SAAS,CAAC;YAEjC,gDAAgD;YAChD,MAAM,cAAc,OAAO,IAAI,CAAC,IAAI;YACpC,IAAI,CAAC,aAAa;gBAChB,MAAM;gBACN;YACF;YAEA,qDAAqD;YACrD,MAAM,YAAY,CAAC;;;;6BAII,EAAE,oBAAoB,YAAY,SAAS,EAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;sBAkCpD,EAAE,QAAQ;;;;;;;;;;;;;MAa1B,CAAC;YAED,YAAY,QAAQ,CAAC,KAAK,CAAC;YAC3B,YAAY,QAAQ,CAAC,KAAK;QAC5B,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,2BAA2B;YACzC,MAAM;QACR;IACF;IAEA,IAAI,CAAC,aAAa,qBAAO,6LAAC;QAAI,WAAU;kBAAgC;;;;;;IAExE,qBACE,6LAAC;QAAI,WAAU;;0BAEb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBACC,SAAS;wBACT,WAAU;;0CAEV,6LAAC,sNAAO;gCAAC,MAAM;;;;;;4BAAM;;;;;;;kCAGvB,6LAAC;wBACC,SAAS;wBACT,WAAU;;0CAEV,6LAAC,yNAAQ;gCAAC,MAAM;;;;;;4BAAM;;;;;;;;;;;;;0BAM1B,6LAAC;gBACC,KAAK;gBACL,WAAU;gBACV,qBAAmB,KAAK,SAAS,CAAC;;kCAElC,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;0CACb,cAAA,6LAAC;oCAAI,KAAI;oCAAY,KAAI;oCAAqB,WAAU;;;;;;;;;;;0CAE1D,6LAAC;gCAAG,WAAU;0CAA+D;;;;;;0CAC7E,6LAAC;gCAAG,WAAU;0CAAkE;;;;;;0CAEhF,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAK,WAAU;0DAA0B;;;;;;0DAC1C,6LAAC;gDAAK,WAAU;0DAA6B,WAAW,YAAY,SAAS;;;;;;;;;;;;kDAE/E,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;gDAAK,WAAU;0DAA0B;;;;;;0DAC1C,6LAAC;gDAAK,WAAU;0DAA0B,oBAAoB,YAAY,SAAS;;;;;;;;;;;;;;;;;;;;;;;;kCAKzF,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;;kDACC,6LAAC;wCAAG,WAAU;kDAA6E;;;;;;kDAG3F,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;;kEAAI,6LAAC;wDAAK,WAAU;kEAA0B;;;;;;oDAAuB,YAAY,SAAS;;;;;;;4CAC1F,YAAY,UAAU,kBAAI,6LAAC;;kEAAI,6LAAC;wDAAK,WAAU;kEAA0B;;;;;;oDAAmB,YAAY,UAAU;;;;;;;4CAClH,YAAY,YAAY,kBAAI,6LAAC;;kEAAI,6LAAC;wDAAK,WAAU;kEAA0B;;;;;;oDAAiB,YAAY,YAAY;;;;;;;4CACpH,YAAY,aAAa,kBAAI,6LAAC;;kEAAI,6LAAC;wDAAK,WAAU;;4DAA0B;4DAAK,YAAY,WAAW,IAAI;4DAAM;;;;;;;oDAAW,YAAY,aAAa;;;;;;;;;;;;;;;;;;;0CAI3J,6LAAC;;kDACC,6LAAC;wCAAG,WAAU;kDAA6E;;;;;;kDAG3F,6LAAC;wCAAI,WAAU;;0DACb,6LAAC;;kEAAI,6LAAC;wDAAK,WAAU;kEAA0B;;;;;;oDAA2B,YAAY,QAAQ;;;;;;;0DAC9F,6LAAC;;kEAAI,6LAAC;wDAAK,WAAU;kEAA0B;;;;;;oDAAiB,WAAW,YAAY,OAAO;;;;;;;0DAC9F,6LAAC;;kEAAI,6LAAC;wDAAK,WAAU;kEAA0B;;;;;;oDAAgB,WAAW,YAAY,QAAQ;;;;;;;4CAC7F,CAAC,YAAY,MAAM,KAAK,aAAa,YAAY,IAAI,KAAK,SAAS,mBAClE,6LAAC;;kEAAI,6LAAC;wDAAK,WAAU;;4DAA2B,YAAY,IAAI,GAAG,UAAU;4DAAQ;;;;;;;oDAAU,YAAY,IAAI,IAAI,YAAY,MAAM;;;;;;;0DAEvI,6LAAC;;kEAAI,6LAAC;wDAAK,WAAU;kEAA0B;;;;;;oDAA4B,eAAe,YAAY,SAAS;;;;;;;;;;;;;;;;;;;;;;;;;kCAKrH,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAG,WAAU;0CAA6E;;;;;;0CAG3F,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;;0DAAI,6LAAC;gDAAK,WAAU;0DAA0B;;;;;;4CAA6B,YAAY,aAAa;;;;;;;oCACpG,YAAY,cAAc,kBAAI,6LAAC;;0DAAI,6LAAC;gDAAK,WAAU;0DAA0B;;;;;;4CAA+B,YAAY,cAAc;;;;;;;;;;;;;;;;;;;oBAI1I,YAAY,SAAS,kBACpB,6LAAC;wBAAI,WAAU;kCACb,cAAA,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAK,WAAU;8CAAa,YAAY,SAAS,CAAC,KAAK;;;;;;8CACxD,6LAAC;;wCAAK;wCAAE,eAAe,YAAY,SAAS,CAAC,eAAe,IAAI;;;;;;;;;;;;;;;;;;kCAKtE,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAK,WAAU;0CAAgE;;;;;;0CAChF,6LAAC;gCAAK,WAAU;0CAAmC,eAAe,YAAY,WAAW;;;;;;;;;;;;kCAG3F,6LAAC;wBAAI,WAAU;;0CACb,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAE,WAAU;kDAA8B;;;;;;kDAC3C,6LAAC;wCAAE,WAAU;kDAAO;;;;;;kDACpB,6LAAC;wCAAE,WAAU;kDAAc;;;;;;;;;;;;0CAE7B,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAI,WAAU;kDACb,cAAA,6LAAC;4CACC,KAAK,CAAC,8DAA8D,EAAE,mBAAmB,yDAAyD;4CAClJ,KAAI;4CACJ,WAAU;;;;;;;;;;;kDAGd,6LAAC;wCAAK,WAAU;kDAA4C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMxE;GAvNM;KAAA;AA0NC,MAAM,mBAA2C,CAAC,EAAE,WAAW,EAAE,OAAO,EAAE;IAC/E,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAG,WAAU;sCAAqB;;;;;;wBAClC,yBACC,6LAAC;4BACC,SAAS;4BACT,WAAU;sCACX;;;;;;;;;;;;8BAKL,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC;wBAAQ,aAAa;wBAAa,SAAS;;;;;;;;;;;;;;;;;;;;;;AAKtD;MArBa;uCAuBE"}},
    {"offset": {"line": 1099, "column": 0}, "map": {"version":3,"sources":["file:///Users/Pascal%20Digny/Github%20Lab/Kabinda%20Lodge%202.0/src/hooks/useRealtimeData.ts"],"sourcesContent":["import { useEffect, useCallback } from 'react';\nimport { supabase } from '@/integrations/supabase/client';\n\nexport interface RealtimeConfig {\n  table: string;\n  event: 'INSERT' | 'UPDATE' | 'DELETE' | '*';\n  filter?: string;\n}\n\ninterface UseRealtimeDataProps {\n  table: string;\n  onInsert?: (payload: unknown) => void;\n  onUpdate?: (payload: unknown) => void;\n  onDelete?: (payload: unknown) => void;\n  onRefresh?: () => void;\n}\n\nexport const useRealtimeData = <T>(\n  config: RealtimeConfig,\n  callback: (data: T) => void\n) => {\n  const setupRealtimeSubscription = useCallback(() => {\n    const channel = supabase\n      .channel(`${config.table}-changes`)\n      .on(\n        'postgres_changes' as any,\n        {\n          event: config.event,\n          schema: 'public',\n          table: config.table,\n          filter: config.filter\n        },\n        (payload: any) => {\n          callback(payload.new as T);\n        }\n      )\n      .subscribe();\n\n    return channel;\n  }, [config.table, config.event, config.filter, callback]);\n\n  useEffect(() => {\n    const channel = setupRealtimeSubscription();\n    \n    return () => {\n      supabase.removeChannel(channel);\n    };\n  }, [setupRealtimeSubscription]);\n};\n\n// Specialized hook for guest data\nexport const useRealtimeGuests = (onRefresh?: () => void) => {\n  useEffect(() => {\n    if (!onRefresh) return;\n\n    const channel = supabase\n      .channel('guests-changes')\n      .on('postgres_changes' as any, { \n        event: 'INSERT', \n        schema: 'public', \n        table: 'users' \n      }, () => {\n        onRefresh();\n      })\n      .subscribe();\n\n    return () => {\n      supabase.removeChannel(channel);\n    };\n  }, [onRefresh]);\n};\n\n// Specialized hook for housekeeping tasks\nexport const useRealtimeHousekeeping = (onRefresh?: () => void) => {\n  useEffect(() => {\n    if (!onRefresh) return;\n\n    const channel = supabase\n      .channel('housekeeping-changes')\n      .on('postgres_changes' as any, { \n        event: '*', \n        schema: 'public', \n        table: 'housekeeping_tasks' \n      }, () => {\n        onRefresh();\n      })\n      .subscribe();\n\n    return () => {\n      supabase.removeChannel(channel);\n    };\n  }, [onRefresh]);\n};\n\n// Specialized hook for room status\nexport const useRealtimeRooms = (onRefresh?: () => void) => {\n  useEffect(() => {\n    if (!onRefresh) return;\n\n    const channel = supabase\n      .channel('rooms-changes')\n      .on('postgres_changes' as any, { \n        event: '*', \n        schema: 'public', \n        table: 'rooms' \n      }, (payload: any) => {\n        // #region agent log\n        fetch('http://127.0.0.1:7242/ingest/ef9571da-842e-45a8-ae05-0af3077edbe8',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'useRealtimeData.ts:102',message:'Rooms real-time event received',data:{eventType:payload.eventType,roomId:payload.new?.id,roomName:payload.new?.name,newStatus:payload.new?.status,oldStatus:payload.old?.status},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'G'})}).catch(()=>{});\n        // #endregion\n        onRefresh();\n      })\n      .subscribe();\n\n    return () => {\n      supabase.removeChannel(channel);\n    };\n  }, [onRefresh]);\n};\n\n// Specialized hook for key cards\nexport const useRealtimeKeyCards = (onRefresh?: () => void) => {\n  useEffect(() => {\n    if (!onRefresh) return;\n\n    const channel = supabase\n      .channel('keycards-changes')\n      .on('postgres_changes' as any, { \n        event: '*', \n        schema: 'public', \n        table: 'key_cards' \n      }, () => {\n        onRefresh();\n      })\n      .subscribe();\n\n    return () => {\n      supabase.removeChannel(channel);\n    };\n  }, [onRefresh]);\n};\n\n// Specialized hook for payments\nexport const useRealtimePayments = (onRefresh?: () => void) => {\n  useEffect(() => {\n    if (!onRefresh) return;\n\n    const channel = supabase\n      .channel('payments-changes')\n      .on('postgres_changes' as any, { \n        event: '*', \n        schema: 'public', \n        table: 'payments' \n      }, () => {\n        onRefresh();\n      })\n      .subscribe();\n\n    return () => {\n      supabase.removeChannel(channel);\n    };\n  }, [onRefresh]);\n};\n\n// Specialized hook for bookings\nexport const useRealtimeBookings = (onRefresh?: () => void) => {\n  useEffect(() => {\n    if (!onRefresh) return;\n\n    const channel = supabase\n      .channel('bookings-changes')\n      .on('postgres_changes' as any, { \n        event: '*', \n        schema: 'public', \n        table: 'bookings' \n      }, () => {\n        onRefresh();\n      })\n      .subscribe();\n\n    return () => {\n      supabase.removeChannel(channel);\n    };\n  }, [onRefresh]);\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1338, "column": 0}, "map": {"version":3,"sources":["file:///Users/Pascal%20Digny/Github%20Lab/Kabinda%20Lodge%202.0/src/hooks/usePaymentMethods.ts"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { supabase } from '@/integrations/supabase/client';\n\nexport interface PaymentMethod {\n  id: string;\n  name: string;\n  code: string;\n  description: string | null;\n  is_active: boolean;\n  icon_name: string | null;\n  created_at: string;\n  updated_at: string;\n}\n\nexport const usePaymentMethods = (includeInactive: boolean = false) => {\n  const [paymentMethods, setPaymentMethods] = useState<PaymentMethod[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<Error | null>(null);\n\n  useEffect(() => {\n    const fetchPaymentMethods = async () => {\n      try {\n        setLoading(true);\n        setError(null);\n        \n        let query = supabase\n          .from('payment_methods')\n          .select('*')\n          .order('name');\n\n        if (!includeInactive) {\n          query = query.eq('is_active', true) as any;\n        }\n\n        const { data, error: fetchError } = await query;\n\n        if (fetchError) throw fetchError;\n\n        setPaymentMethods(data || []);\n      } catch (err) {\n        console.error('Error fetching payment methods:', err);\n        setError(err instanceof Error ? err : new Error('Failed to fetch payment methods'));\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    fetchPaymentMethods();\n\n    // Subscribe to real-time updates\n    const channel = supabase\n      .channel('payment_methods_changes')\n      .on(\n        'postgres_changes',\n        {\n          event: '*',\n          schema: 'public',\n          table: 'payment_methods',\n        },\n        () => {\n          // Refetch payment methods when changes occur\n          fetchPaymentMethods();\n        }\n      )\n      .subscribe();\n\n    return () => {\n      supabase.removeChannel(channel);\n    };\n  }, [includeInactive]);\n\n  return { paymentMethods, loading, error };\n};\n\n\n\n\n\n"],"names":[],"mappings":";;;;AAAA;AACA;;;;AAaO,MAAM,oBAAoB,CAAC,kBAA2B,KAAK;;IAChE,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yKAAQ,EAAkB,EAAE;IACxE,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAe;IAEjD,IAAA,0KAAS;uCAAC;YACR,MAAM;mEAAsB;oBAC1B,IAAI;wBACF,WAAW;wBACX,SAAS;wBAET,IAAI,QAAQ,wJAAQ,CACjB,IAAI,CAAC,mBACL,MAAM,CAAC,KACP,KAAK,CAAC;wBAET,IAAI,CAAC,iBAAiB;4BACpB,QAAQ,MAAM,EAAE,CAAC,aAAa;wBAChC;wBAEA,MAAM,EAAE,IAAI,EAAE,OAAO,UAAU,EAAE,GAAG,MAAM;wBAE1C,IAAI,YAAY,MAAM;wBAEtB,kBAAkB,QAAQ,EAAE;oBAC9B,EAAE,OAAO,KAAK;wBACZ,QAAQ,KAAK,CAAC,mCAAmC;wBACjD,SAAS,eAAe,QAAQ,MAAM,IAAI,MAAM;oBAClD,SAAU;wBACR,WAAW;oBACb;gBACF;;YAEA;YAEA,iCAAiC;YACjC,MAAM,UAAU,wJAAQ,CACrB,OAAO,CAAC,2BACR,EAAE,CACD,oBACA;gBACE,OAAO;gBACP,QAAQ;gBACR,OAAO;YACT;uDACA;oBACE,6CAA6C;oBAC7C;gBACF;sDAED,SAAS;YAEZ;+CAAO;oBACL,wJAAQ,CAAC,aAAa,CAAC;gBACzB;;QACF;sCAAG;QAAC;KAAgB;IAEpB,OAAO;QAAE;QAAgB;QAAS;IAAM;AAC1C;GA1Da"}},
    {"offset": {"line": 1409, "column": 0}, "map": {"version":3,"sources":["file:///Users/Pascal%20Digny/Github%20Lab/Kabinda%20Lodge%202.0/src/utils/bookingUtils.ts"],"sourcesContent":["/**\n * Utility functions for booking operations\n * Handles 9:30 AM expiration logic for bookings\n */\n\n/**\n * Get the current date and time in Africa/Lubumbashi timezone\n */\nexport function getLocalDateTime(): { date: string; time: string; hour: number; minute: number } {\n  // Create a date in Africa/Lubumbashi timezone (CAT - Central Africa Time, UTC+2)\n  const now = new Date();\n  const lubumbashiOffset = 2 * 60; // UTC+2 in minutes\n  const utc = now.getTime() + (now.getTimezoneOffset() * 60000);\n  const lubumbashiTime = new Date(utc + (lubumbashiOffset * 60000));\n  \n  const year = lubumbashiTime.getFullYear();\n  const month = String(lubumbashiTime.getMonth() + 1).padStart(2, '0');\n  const day = String(lubumbashiTime.getDate()).padStart(2, '0');\n  const hour = lubumbashiTime.getHours();\n  const minute = lubumbashiTime.getMinutes();\n  \n  return {\n    date: `${year}-${month}-${day}`,\n    time: `${String(hour).padStart(2, '0')}:${String(minute).padStart(2, '0')}`,\n    hour,\n    minute\n  };\n}\n\n/**\n * Check if a booking is currently active considering 9:30 AM expiration\n * A booking is active if:\n * - It has started (start_date <= today)\n * - It hasn't expired:\n *   - If end_date is in the future, it's active\n *   - If end_date is today, it's active only if current time is before 9:30 AM\n *   - If end_date is in the past, it's not active\n * \n * @param startDate - Booking start date (YYYY-MM-DD)\n * @param endDate - Booking end date (YYYY-MM-DD)\n * @param status - Booking status (must be 'booked', 'confirmed', or 'pending_verification')\n * @returns true if booking is active, false otherwise\n */\nexport function isBookingActive(\n  startDate: string,\n  endDate: string,\n  status: string\n): boolean {\n  const activeStatuses = ['booked', 'confirmed', 'pending_verification', 'checked-in'];\n  \n  // Check if status is active\n  if (!status || !activeStatuses.includes(status)) {\n    return false;\n  }\n  \n  const { date: today, hour, minute } = getLocalDateTime();\n  \n  // Booking hasn't started yet\n  if (startDate > today) {\n    return false;\n  }\n  \n  // Booking ended on a previous day\n  if (endDate < today) {\n    return false;\n  }\n  \n  // Booking ends today - check if it's before 9:30 AM\n  if (endDate === today) {\n    // If current time is 9:30 AM or later, booking has expired\n    if (hour > 9 || (hour === 9 && minute >= 30)) {\n      return false;\n    }\n    return true;\n  }\n  \n  // Booking ends in the future\n  return true;\n}\n\n/**\n * Check if a date range conflicts with any active bookings\n * Considers 9:30 AM expiration when checking for conflicts\n * \n * @param startDate - Proposed start date (YYYY-MM-DD)\n * @param endDate - Proposed end date (YYYY-MM-DD)\n * @param existingBookings - Array of existing bookings with start_date, end_date, and status\n * @returns true if there's a conflict, false otherwise\n */\nexport function hasBookingConflict(\n  startDate: string,\n  endDate: string,\n  existingBookings: Array<{ start_date: string; end_date: string; status: string }>\n): boolean {\n  for (const booking of existingBookings) {\n    // Skip if booking is not active (isBookingActive already handles 9:30 AM expiration)\n    if (!isBookingActive(booking.start_date, booking.end_date, booking.status)) {\n      continue;\n    }\n    \n    // Check for date overlap\n    // Conflict exists if: startDate < booking.end_date AND endDate > booking.start_date\n    if (startDate < booking.end_date && endDate > booking.start_date) {\n      return true;\n    }\n  }\n  \n  return false;\n}\n\n/**\n * Get all bookings that conflict with a proposed date range\n * Considers 9:30 AM expiration when checking for conflicts\n * \n * @param startDate - Proposed start date (YYYY-MM-DD)\n * @param endDate - Proposed end date (YYYY-MM-DD)\n * @param existingBookings - Array of existing bookings with start_date, end_date, and status\n * @returns Array of conflicting bookings\n */\nexport function getConflictingBookings<T extends { start_date: string; end_date: string; status: string }>(\n  startDate: string,\n  endDate: string,\n  existingBookings: T[]\n): T[] {\n  return existingBookings.filter(booking => {\n    // Skip if booking is not active (isBookingActive already handles 9:30 AM expiration)\n    if (!isBookingActive(booking.start_date, booking.end_date, booking.status)) {\n      return false;\n    }\n    \n    // Check for date overlap\n    // Conflict exists if: startDate < booking.end_date AND endDate > booking.start_date\n    return startDate < booking.end_date && endDate > booking.start_date;\n  });\n}\n\n/**\n * Filter active bookings from an array of bookings\n * \n * @param bookings - Array of bookings with start_date, end_date, and status\n * @returns Array of active bookings\n */\nexport function filterActiveBookings<T extends { start_date: string; end_date: string; status: string }>(\n  bookings: T[]\n): T[] {\n  return bookings.filter(booking => \n    isBookingActive(booking.start_date, booking.end_date, booking.status)\n  );\n}\n\n"],"names":[],"mappings":"AAAA;;;CAGC,GAED;;CAEC;;;;;;;;;;;;AACM,SAAS;IACd,iFAAiF;IACjF,MAAM,MAAM,IAAI;IAChB,MAAM,mBAAmB,IAAI,IAAI,mBAAmB;IACpD,MAAM,MAAM,IAAI,OAAO,KAAM,IAAI,iBAAiB,KAAK;IACvD,MAAM,iBAAiB,IAAI,KAAK,MAAO,mBAAmB;IAE1D,MAAM,OAAO,eAAe,WAAW;IACvC,MAAM,QAAQ,OAAO,eAAe,QAAQ,KAAK,GAAG,QAAQ,CAAC,GAAG;IAChE,MAAM,MAAM,OAAO,eAAe,OAAO,IAAI,QAAQ,CAAC,GAAG;IACzD,MAAM,OAAO,eAAe,QAAQ;IACpC,MAAM,SAAS,eAAe,UAAU;IAExC,OAAO;QACL,MAAM,GAAG,KAAK,CAAC,EAAE,MAAM,CAAC,EAAE,KAAK;QAC/B,MAAM,GAAG,OAAO,MAAM,QAAQ,CAAC,GAAG,KAAK,CAAC,EAAE,OAAO,QAAQ,QAAQ,CAAC,GAAG,MAAM;QAC3E;QACA;IACF;AACF;AAgBO,SAAS,gBACd,SAAiB,EACjB,OAAe,EACf,MAAc;IAEd,MAAM,iBAAiB;QAAC;QAAU;QAAa;QAAwB;KAAa;IAEpF,4BAA4B;IAC5B,IAAI,CAAC,UAAU,CAAC,eAAe,QAAQ,CAAC,SAAS;QAC/C,OAAO;IACT;IAEA,MAAM,EAAE,MAAM,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG;IAEtC,6BAA6B;IAC7B,IAAI,YAAY,OAAO;QACrB,OAAO;IACT;IAEA,kCAAkC;IAClC,IAAI,UAAU,OAAO;QACnB,OAAO;IACT;IAEA,oDAAoD;IACpD,IAAI,YAAY,OAAO;QACrB,2DAA2D;QAC3D,IAAI,OAAO,KAAM,SAAS,KAAK,UAAU,IAAK;YAC5C,OAAO;QACT;QACA,OAAO;IACT;IAEA,6BAA6B;IAC7B,OAAO;AACT;AAWO,SAAS,mBACd,SAAiB,EACjB,OAAe,EACf,gBAAiF;IAEjF,KAAK,MAAM,WAAW,iBAAkB;QACtC,qFAAqF;QACrF,IAAI,CAAC,gBAAgB,QAAQ,UAAU,EAAE,QAAQ,QAAQ,EAAE,QAAQ,MAAM,GAAG;YAC1E;QACF;QAEA,yBAAyB;QACzB,oFAAoF;QACpF,IAAI,YAAY,QAAQ,QAAQ,IAAI,UAAU,QAAQ,UAAU,EAAE;YAChE,OAAO;QACT;IACF;IAEA,OAAO;AACT;AAWO,SAAS,uBACd,SAAiB,EACjB,OAAe,EACf,gBAAqB;IAErB,OAAO,iBAAiB,MAAM,CAAC,CAAA;QAC7B,qFAAqF;QACrF,IAAI,CAAC,gBAAgB,QAAQ,UAAU,EAAE,QAAQ,QAAQ,EAAE,QAAQ,MAAM,GAAG;YAC1E,OAAO;QACT;QAEA,yBAAyB;QACzB,oFAAoF;QACpF,OAAO,YAAY,QAAQ,QAAQ,IAAI,UAAU,QAAQ,UAAU;IACrE;AACF;AAQO,SAAS,qBACd,QAAa;IAEb,OAAO,SAAS,MAAM,CAAC,CAAA,UACrB,gBAAgB,QAAQ,UAAU,EAAE,QAAQ,QAAQ,EAAE,QAAQ,MAAM;AAExE"}},
    {"offset": {"line": 1510, "column": 0}, "map": {"version":3,"sources":["file:///Users/Pascal%20Digny/Github%20Lab/Kabinda%20Lodge%202.0/src/components/ui/select.tsx"],"sourcesContent":["import * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AAAA;AAAA;AAEA;;;;;;AAEA,MAAM,SAAS,6KAAoB;AAEnC,MAAM,cAAc,8KAAqB;AAEzC,MAAM,cAAc,8KAAqB;AAEzC,MAAM,8BAAgB,2KAAgB,MAGpC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,6LAAC,gLAAuB;QACtB,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,mTACA;QAED,GAAG,KAAK;;YAER;0BACD,6LAAC,6KAAoB;gBAAC,OAAO;0BAC3B,cAAA,6LAAC,sOAAW;oBAAC,WAAU;;;;;;;;;;;;;;;;;;AAI7B,cAAc,WAAW,GAAG,gLAAuB,CAAC,WAAW;AAE/D,MAAM,qCAAuB,2KAAgB,CAG3C,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,uLAA8B;QAC7B,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,wDACA;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,gOAAS;YAAC,WAAU;;;;;;;;;;;MAZnB;AAeN,qBAAqB,WAAW,GAAG,uLAA8B,CAAC,WAAW;AAE7E,MAAM,uCAAyB,2KAAgB,CAG7C,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,yLAAgC;QAC/B,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,wDACA;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,sOAAW;YAAC,WAAU;;;;;;;;;;;MAZrB;AAeN,uBAAuB,WAAW,GAChC,yLAAgC,CAAC,WAAW;AAE9C,MAAM,8BAAgB,2KAAgB,OAGpC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,WAAW,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACzD,6LAAC,+KAAsB;kBACrB,cAAA,6LAAC,gLAAuB;YACtB,KAAK;YACL,WAAW,IAAA,4HAAE,EACX,ucACA,aAAa,YACX,mIACF;YAEF,UAAU;YACT,GAAG,KAAK;;8BAET,6LAAC;;;;;8BACD,6LAAC,iLAAwB;oBACvB,WAAW,IAAA,4HAAE,EACX,OACA,aAAa,YACX;8BAGH;;;;;;8BAEH,6LAAC;;;;;;;;;;;;;;;;;AAIP,cAAc,WAAW,GAAG,gLAAuB,CAAC,WAAW;AAE/D,MAAM,4BAAc,2KAAgB,OAGlC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,8KAAqB;QACpB,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,0CAA0C;QACvD,GAAG,KAAK;;;;;;;AAGb,YAAY,WAAW,GAAG,8KAAqB,CAAC,WAAW;AAE3D,MAAM,2BAAa,2KAAgB,OAGjC,CAAC,EAAE,SAAS,EAAE,QAAQ,EAAE,GAAG,OAAO,EAAE,oBACpC,6LAAC,6KAAoB;QACnB,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,6NACA;QAED,GAAG,KAAK;;0BAET,6LAAC;gBAAK,WAAU;0BACd,cAAA,6LAAC,sLAA6B;8BAC5B,cAAA,6LAAC,gNAAK;wBAAC,WAAU;;;;;;;;;;;;;;;;0BAIrB,6LAAC,iLAAwB;0BAAE;;;;;;;;;;;;;AAG/B,WAAW,WAAW,GAAG,6KAAoB,CAAC,WAAW;AAEzD,MAAM,gCAAkB,2KAAgB,QAGtC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,kLAAyB;QACxB,KAAK;QACL,WAAW,IAAA,4HAAE,EAAC,4BAA4B;QACzC,GAAG,KAAK;;;;;;;AAGb,gBAAgB,WAAW,GAAG,kLAAyB,CAAC,WAAW"}},
    {"offset": {"line": 1732, "column": 0}, "map": {"version":3,"sources":["file:///Users/Pascal%20Digny/Github%20Lab/Kabinda%20Lodge%202.0/src/components/ui/checkbox.tsx"],"sourcesContent":["import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAEA;;;;;;AAEA,MAAM,yBAAW,2KAAgB,MAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC,+KAAsB;QACrB,KAAK;QACL,WAAW,IAAA,4HAAE,EACX,kTACA;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,oLAA2B;YAC1B,WAAW,IAAA,4HAAE,EAAC;sBAEd,cAAA,6LAAC,gNAAK;gBAAC,WAAU;;;;;;;;;;;;;;;;;AAIvB,SAAS,WAAW,GAAG,+KAAsB,CAAC,WAAW"}},
    {"offset": {"line": 1782, "column": 0}, "map": {"version":3,"sources":["file:///Users/Pascal%20Digny/Github%20Lab/Kabinda%20Lodge%202.0/src/utils/dynamicFields.tsx"],"sourcesContent":["import React from 'react';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Textarea } from '@/components/ui/textarea';\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select';\nimport { Checkbox } from '@/components/ui/checkbox';\nimport { BookingFieldConfig, DynamicFieldData } from '@/types/bookingFields';\n\n/**\n * Render a dynamic field based on its configuration\n */\nexport const renderDynamicField = (\n  field: BookingFieldConfig,\n  value: string | number | boolean,\n  onChange: (value: string | number | boolean) => void,\n  error?: string\n): React.ReactNode => {\n  const fieldId = `dynamic-field-${field.id}`;\n  const baseProps = {\n    id: fieldId,\n    placeholder: field.placeholder || '',\n    required: field.is_required,\n    value: value?.toString() || '',\n  };\n\n  switch (field.field_type) {\n    case 'text':\n      return (\n        <div key={field.id} className=\"space-y-2\">\n          <Label htmlFor={fieldId}>\n            {field.field_label}\n            {field.is_required && <span className=\"text-red-500 ml-1\">*</span>}\n          </Label>\n          <Input\n            {...baseProps}\n            type=\"text\"\n            onChange={(e) => onChange(e.target.value)}\n          />\n          {error && <p className=\"text-sm text-red-500\">{error}</p>}\n        </div>\n      );\n\n    case 'email':\n      return (\n        <div key={field.id} className=\"space-y-2\">\n          <Label htmlFor={fieldId}>\n            {field.field_label}\n            {field.is_required && <span className=\"text-red-500 ml-1\">*</span>}\n          </Label>\n          <Input\n            {...baseProps}\n            type=\"email\"\n            onChange={(e) => onChange(e.target.value)}\n          />\n          {error && <p className=\"text-sm text-red-500\">{error}</p>}\n        </div>\n      );\n\n    case 'phone':\n      return (\n        <div key={field.id} className=\"space-y-2\">\n          <Label htmlFor={fieldId}>\n            {field.field_label}\n            {field.is_required && <span className=\"text-red-500 ml-1\">*</span>}\n          </Label>\n          <Input\n            {...baseProps}\n            type=\"tel\"\n            onChange={(e) => onChange(e.target.value)}\n          />\n          {error && <p className=\"text-sm text-red-500\">{error}</p>}\n        </div>\n      );\n\n    case 'number':\n      return (\n        <div key={field.id} className=\"space-y-2\">\n          <Label htmlFor={fieldId}>\n            {field.field_label}\n            {field.is_required && <span className=\"text-red-500 ml-1\">*</span>}\n          </Label>\n          <Input\n            {...baseProps}\n            type=\"number\"\n            onChange={(e) => onChange(parseInt(e.target.value) || 0)}\n          />\n          {error && <p className=\"text-sm text-red-500\">{error}</p>}\n        </div>\n      );\n\n    case 'textarea':\n      return (\n        <div key={field.id} className=\"space-y-2\">\n          <Label htmlFor={fieldId}>\n            {field.field_label}\n            {field.is_required && <span className=\"text-red-500 ml-1\">*</span>}\n          </Label>\n          <Textarea\n            id={fieldId}\n            placeholder={field.placeholder || ''}\n            required={field.is_required}\n            value={value?.toString() || ''}\n            onChange={(e) => onChange(e.target.value)}\n            rows={3}\n          />\n          {error && <p className=\"text-sm text-red-500\">{error}</p>}\n        </div>\n      );\n\n    case 'date':\n      return (\n        <div key={field.id} className=\"space-y-2\">\n          <Label htmlFor={fieldId}>\n            {field.field_label}\n            {field.is_required && <span className=\"text-red-500 ml-1\">*</span>}\n          </Label>\n          <Input\n            {...baseProps}\n            type=\"date\"\n            onChange={(e) => onChange(e.target.value)}\n          />\n          {error && <p className=\"text-sm text-red-500\">{error}</p>}\n        </div>\n      );\n\n    case 'select':\n      return (\n        <div key={field.id} className=\"space-y-2\">\n          <Label htmlFor={fieldId}>\n            {field.field_label}\n            {field.is_required && <span className=\"text-red-500 ml-1\">*</span>}\n          </Label>\n          <Select\n            value={value?.toString() || ''}\n            onValueChange={(val) => onChange(val)}\n            required={field.is_required}\n          >\n            <SelectTrigger id={fieldId}>\n              <SelectValue placeholder={field.placeholder || 'Select an option'} />\n            </SelectTrigger>\n            <SelectContent>\n              {field.options && field.options.length > 0 ? (\n                field.options.map((option, index) => (\n                  <SelectItem key={index} value={option}>\n                    {option}\n                  </SelectItem>\n                ))\n              ) : (\n                <SelectItem value=\"\" disabled>No options available</SelectItem>\n              )}\n            </SelectContent>\n          </Select>\n          {error && <p className=\"text-sm text-red-500\">{error}</p>}\n        </div>\n      );\n\n    case 'checkbox':\n      return (\n        <div key={field.id} className=\"flex items-center space-x-2\">\n          <Checkbox\n            id={fieldId}\n            checked={value === true || value === 'true'}\n            onCheckedChange={(checked) => onChange(checked ? true : false)}\n            required={field.is_required}\n          />\n          <Label htmlFor={fieldId} className=\"cursor-pointer\">\n            {field.field_label}\n            {field.is_required && <span className=\"text-red-500 ml-1\">*</span>}\n          </Label>\n          {error && <p className=\"text-sm text-red-500 ml-2\">{error}</p>}\n        </div>\n      );\n\n    default:\n      return null;\n  }\n};\n\n/**\n * Validate a dynamic field value\n */\nexport const validateDynamicField = (\n  field: BookingFieldConfig,\n  value: string | number | boolean\n): string | null => {\n  if (field.is_required) {\n    if (value === null || value === undefined || value === '' || value === false) {\n      return `${field.field_label} is required`;\n    }\n  }\n\n  // Type-specific validation\n  if (value !== null && value !== undefined && value !== '') {\n    switch (field.field_type) {\n      case 'email':\n        const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n        if (!emailRegex.test(value.toString())) {\n          return 'Please enter a valid email address';\n        }\n        break;\n\n      case 'phone':\n        const phoneRegex = /^[\\d\\s\\+\\-\\(\\)]+$/;\n        if (!phoneRegex.test(value.toString())) {\n          return 'Please enter a valid phone number';\n        }\n        break;\n\n      case 'number':\n        if (isNaN(Number(value))) {\n          return 'Please enter a valid number';\n        }\n        break;\n    }\n  }\n\n  return null;\n};\n\n/**\n * Validate all dynamic fields\n */\nexport const validateDynamicFields = (\n  fields: BookingFieldConfig[],\n  values: DynamicFieldData\n): Record<string, string> => {\n  const errors: Record<string, string> = {};\n\n  fields.forEach((field) => {\n    const value = values[field.field_name];\n    const error = validateDynamicField(field, value);\n    if (error) {\n      errors[field.field_name] = error;\n    }\n  });\n\n  return errors;\n};\n\n\n\n\n\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2266, "column": 0}, "map": {"version":3,"sources":["file:///Users/Pascal%20Digny/Github%20Lab/Kabinda%20Lodge%202.0/src/page-components/BookRoom.tsx"],"sourcesContent":["import React, { useState, useEffect, useMemo, useCallback } from \"react\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { supabase } from \"@/integrations/supabase/client\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { ReceiptGenerator } from \"@/components/ReceiptGenerator\";\nimport { useRealtimeRooms } from \"@/hooks/useRealtimeData\";\nimport { usePaymentMethods } from \"@/hooks/usePaymentMethods\";\nimport { Calendar, Users, MapPin, Phone, CreditCard, CheckCircle, Tag, Gift } from \"lucide-react\";\nimport { hasBookingConflict, getConflictingBookings } from \"@/utils/bookingUtils\";\nimport { BookingFieldConfig, DynamicFieldData } from \"@/types/bookingFields\";\nimport { renderDynamicField, validateDynamicFields } from \"@/utils/dynamicFields\";\n\ntype PartnerPromotion = {\n  id: number;\n  title: string;\n  description?: string | null;\n  discount_percent: number;\n  discount_type?: \"percentage\" | \"fixed\" | null;\n  discount_amount?: number | null;\n  partner_name?: string | null;\n  minimum_amount?: number | null;\n  maximum_uses?: number | null;\n  current_uses?: number | null;\n  promotion_type?: string | null;\n  start_date?: string | null;\n  end_date?: string | null;\n  is_active?: boolean | null;\n};\n\n\nconst BookRoom = () => {\n  const { id } = useParams();\n  const navigate = useNavigate();\n  const { toast } = useToast();\n  const { user, session, userRole, loading: authLoading } = useAuth();\n  const { paymentMethods, loading: paymentMethodsLoading } = usePaymentMethods();\n  const [room, setRoom] = useState<{ id: number; name: string; type: string; price: number; description?: string } | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [submitting, setSubmitting] = useState(false);\n  const [step, setStep] = useState(1);\n  const [bookingId, setBookingId] = useState<number | null>(null);\n  const [showReceipt, setShowReceipt] = useState(false);\n  const [activePromotion, setActivePromotion] = useState<{ id: number; title: string; discount_percent: number; description: string } | null>(null);\n  const [dateConflict, setDateConflict] = useState<string | null>(null);\n  const [dynamicFields, setDynamicFields] = useState<BookingFieldConfig[]>([]);\n  const [dynamicFieldValues, setDynamicFieldValues] = useState<DynamicFieldData>({});\n  const [dynamicFieldErrors, setDynamicFieldErrors] = useState<Record<string, string>>({});\n  const [isPartnerBooking, setIsPartnerBooking] = useState(false);\n  const [partnerPromotions, setPartnerPromotions] = useState<PartnerPromotion[]>([]);\n  const [partnerPromotionsLoading, setPartnerPromotionsLoading] = useState(false);\n  const [partnerPromotionsFetched, setPartnerPromotionsFetched] = useState(false);\n  const [partnerPromotionError, setPartnerPromotionError] = useState<string | null>(null);\n  const [selectedPartnerPromotionId, setSelectedPartnerPromotionId] = useState<string>(\"\");\n\n  const handleBookingTypeSelect = useCallback(\n    (type: \"standard\" | \"partner\") => {\n      if (type === \"partner\") {\n        setIsPartnerBooking(true);\n        if (!selectedPartnerPromotionId) {\n          setPartnerPromotionError(null);\n        }\n      } else {\n        setIsPartnerBooking(false);\n        setSelectedPartnerPromotionId(\"\");\n        setPartnerPromotionError(null);\n      }\n    },\n    [selectedPartnerPromotionId]\n  );\n\n  const handlePartnerPromotionSelect = useCallback(\n    (value: string) => {\n      setSelectedPartnerPromotionId(value);\n      if (!value) {\n        setPartnerPromotionError(null);\n      }\n    },\n    []\n  );\n\n  const [formData, setFormData] = useState({\n    startDate: \"\",\n    endDate: \"\",\n    guests: 1,\n    notes: \"\",\n    contactPhone: \"\",\n    transactionRef: \"\",\n    paymentMethod: \"\",\n    guestName: \"\",\n    guestEmail: \"\",\n    guestCompany: \"\",\n    idType: \"\",\n    idNumber: \"\"\n  });\n\n  const fetchPartnerPromotions = useCallback(async () => {\n    try {\n      setPartnerPromotionsLoading(true);\n      const today = new Date();\n\n      console.log('🔍 Fetching partner promotions...');\n\n      const selectColumns =\n        \"id, title, description, discount_percent, discount_type, discount_amount, partner_name, minimum_amount, maximum_uses, current_uses, promotion_type, start_date, end_date, is_active\";\n\n      const primaryResponse = await (supabase as any)\n        .from(\"promotions\")\n        .select(selectColumns)\n        .eq(\"promotion_type\", \"partner\")\n        .eq(\"is_active\", true)\n        .order(\"title\", { ascending: true });\n\n      console.log('📦 Primary response:', primaryResponse);\n\n      let promotionsData: PartnerPromotion[] | null = null;\n\n      if (primaryResponse.error) {\n        console.warn('⚠️ Primary query failed, trying fallback:', primaryResponse.error);\n\n        // Fallback: fetch all promotions and filter client-side (handles older schemas without promotion_type / is_active columns)\n        const fallbackResponse = await (supabase as any)\n          .from(\"promotions\")\n          .select(\"*\")\n          .order(\"title\", { ascending: true });\n\n        console.log('📦 Fallback response:', fallbackResponse);\n\n        if (fallbackResponse.error) {\n          throw fallbackResponse.error;\n        }\n\n        promotionsData = (fallbackResponse.data ?? []) as unknown as PartnerPromotion[];\n      } else {\n        promotionsData = (primaryResponse.data ?? []) as unknown as PartnerPromotion[];\n      }\n\n      console.log('📊 Raw promotions data:', promotionsData);\n\n      const filteredPromotions = (promotionsData || []).filter((promotion) => {\n        const isPartnerPromotion =\n          promotion.promotion_type === \"partner\" ||\n          promotion.title?.toLowerCase().includes(\"partner\") ||\n          promotion.title?.includes(\"-\") ||\n          promotion.partner_name;\n\n        if (!isPartnerPromotion) {\n          console.log('❌ Not a partner promotion:', promotion.title);\n          return false;\n        }\n\n        if (\n          Object.prototype.hasOwnProperty.call(promotion, \"is_active\") &&\n          promotion.is_active === false\n        ) {\n          console.log('❌ Inactive promotion:', promotion.title);\n          return false;\n        }\n\n        const startDate = promotion.start_date ? new Date(promotion.start_date) : null;\n        const endDate = promotion.end_date ? new Date(promotion.end_date) : null;\n\n        const hasStarted = !startDate || startDate <= today;\n        const notExpired = !endDate || endDate >= today;\n\n        if (!hasStarted || !notExpired) {\n          console.log('❌ Date range invalid:', promotion.title, { startDate, endDate, today });\n        }\n\n        return hasStarted && notExpired;\n      });\n\n      console.log('✅ Filtered partner promotions:', filteredPromotions);\n      setPartnerPromotions(filteredPromotions);\n    } catch (error) {\n      console.error(\"❌ Error fetching partner promotions:\", error);\n      toast({\n        title: \"Partner rates unavailable\",\n        description: \"We couldn't load partner promotions right now. Please try again or continue with the standard rate.\",\n        variant: \"destructive\"\n      });\n    } finally {\n      setPartnerPromotionsLoading(false);\n      setPartnerPromotionsFetched(true);\n    }\n  }, [toast]);\n\n  const selectedPartnerPromotion = useMemo(\n    () => partnerPromotions.find((promotion) => promotion.id.toString() === selectedPartnerPromotionId) || null,\n    [partnerPromotions, selectedPartnerPromotionId]\n  );\n\n  const nights = useMemo(() => {\n    if (!formData.startDate || !formData.endDate) return 0;\n    const start = new Date(formData.startDate);\n    const end = new Date(formData.endDate);\n    const diffTime = end.getTime() - start.getTime();\n    if (Number.isNaN(diffTime) || diffTime <= 0) return 0;\n    return Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n  }, [formData.startDate, formData.endDate]);\n\n  const baseTotal = useMemo(() => {\n    if (!room) return 0;\n    return nights * (room.price || 0);\n  }, [nights, room]);\n\n  const partnerDiscountAmount = useMemo(() => {\n    if (!selectedPartnerPromotion || baseTotal <= 0 || nights <= 0) return 0;\n\n    const minimumAmount = Number(selectedPartnerPromotion.minimum_amount ?? 0);\n    if (minimumAmount > 0 && baseTotal < minimumAmount) {\n      return 0;\n    }\n\n    let discount = 0;\n    if (selectedPartnerPromotion.discount_type === \"fixed\" && selectedPartnerPromotion.discount_amount !== null && selectedPartnerPromotion.discount_amount !== undefined) {\n      // Apply fixed discount PER NIGHT (multiply by number of nights)\n      discount = Number(selectedPartnerPromotion.discount_amount) * nights;\n    } else {\n      const percent = Number(selectedPartnerPromotion.discount_percent || 0);\n      discount = baseTotal * (percent / 100);\n    }\n\n    if (!Number.isFinite(discount) || discount < 0) {\n      return 0;\n    }\n\n    return Math.min(discount, baseTotal);\n  }, [selectedPartnerPromotion, baseTotal, nights]);\n\n  const finalTotal = useMemo(() => Math.max(baseTotal - partnerDiscountAmount, 0), [baseTotal, partnerDiscountAmount]);\n  const hasBookingAmount = finalTotal > 0 || baseTotal > 0;\n\n  const eligiblePartnerPromotions = useMemo(() => {\n    if (partnerPromotions.length === 0) return [];\n\n    return partnerPromotions.filter((promotion) => {\n      const usageLimit = promotion.maximum_uses !== null && promotion.maximum_uses !== undefined;\n      const usageExceeded =\n        usageLimit &&\n        promotion.current_uses !== null &&\n        promotion.current_uses !== undefined &&\n        Number(promotion.current_uses) >= Number(promotion.maximum_uses);\n\n      if (usageExceeded) {\n        return false;\n      }\n\n      const minimumAmount = Number(promotion.minimum_amount ?? 0);\n      if (minimumAmount > 0 && baseTotal > 0 && baseTotal < minimumAmount) {\n        return false;\n      }\n\n      return true;\n    });\n  }, [partnerPromotions, baseTotal]);\n\n  const formatCurrency = useCallback((amount: number) => {\n    if (!Number.isFinite(amount)) return \"0.00\";\n    return amount.toLocaleString(undefined, {\n      minimumFractionDigits: 2,\n      maximumFractionDigits: 2\n    });\n  }, []);\n\n  const isPartnerSelectionValid =\n    !isPartnerBooking || (!partnerPromotionError && !partnerPromotionsLoading);\n  const disableBookingSubmit = submitting || !isPartnerSelectionValid;\n\n  const partnerPromotionReceipt = useMemo(() => {\n    if (partnerDiscountAmount > 0 && selectedPartnerPromotion && baseTotal > 0) {\n      let discountPercentForReceipt = Number(selectedPartnerPromotion.discount_percent || 0);\n      if (selectedPartnerPromotion.discount_type === \"fixed\" && baseTotal > 0) {\n        discountPercentForReceipt = Number(((partnerDiscountAmount / baseTotal) * 100).toFixed(2));\n      }\n\n      return {\n        title: selectedPartnerPromotion.title,\n        description: selectedPartnerPromotion.description || \"\",\n        discount_percent: discountPercentForReceipt\n      };\n    }\n    return null;\n  }, [partnerDiscountAmount, selectedPartnerPromotion, baseTotal]);\n\n  const receiptPromotion = partnerPromotionReceipt || activePromotion || undefined;\n\n  const nightlyBaseRate = room?.price || 0;\n  const nightlyDiscount = useMemo(() => {\n    if (nights <= 0) return 0;\n    return partnerDiscountAmount / nights;\n  }, [partnerDiscountAmount, nights]);\n\n  const nightlyTotal = useMemo(() => {\n    if (nights <= 0) return nightlyBaseRate;\n    return Math.max((finalTotal || 0) / nights, 0);\n  }, [finalTotal, nights, nightlyBaseRate]);\n\n\n  // Use realtime data for rooms\n  useRealtimeRooms(() => {\n    if (id && !room) {\n      fetchRoom();\n    }\n  });\n\n  useEffect(() => {\n    // Component mounted/updated\n    \n    if (authLoading) {\n\n      return;\n    }\n    \n    if (!user) {\n\n      navigate('/kabinda-lodge/client-auth');\n      return;\n    }\n    \n\n    if (id) {\n      fetchRoom();\n      fetchActivePromotion();\n      fetchDynamicFields();\n    }\n  }, [user, userRole, authLoading, id, navigate]);\n\n  useEffect(() => {\n    fetchPartnerPromotions().catch(console.error);\n  }, [fetchPartnerPromotions]);\n\n  useEffect(() => {\n    if (\n      isPartnerBooking &&\n      !partnerPromotionsFetched &&\n      !partnerPromotionsLoading &&\n      partnerPromotions.length === 0\n    ) {\n      fetchPartnerPromotions().catch(console.error);\n    }\n  }, [\n    isPartnerBooking,\n    partnerPromotionsFetched,\n    partnerPromotionsLoading,\n    partnerPromotions.length,\n    fetchPartnerPromotions\n  ]);\n\n  useEffect(() => {\n    if (!selectedPartnerPromotion) {\n      setPartnerPromotionError(null);\n      return;\n    }\n\n    const minimumAmount = Number(selectedPartnerPromotion.minimum_amount ?? 0);\n\n    if (minimumAmount > 0 && baseTotal < minimumAmount) {\n      setPartnerPromotionError(`Minimum booking amount of $${formatCurrency(minimumAmount)} required for this partner promotion.`);\n      return;\n    }\n\n    setPartnerPromotionError(null);\n  }, [selectedPartnerPromotion, baseTotal, formatCurrency]);\n\n  useEffect(() => {\n    if (!selectedPartnerPromotionId) return;\n\n    const stillEligible = eligiblePartnerPromotions.some((promotion) => promotion.id.toString() === selectedPartnerPromotionId);\n    if (!stillEligible) {\n      if (selectedPartnerPromotion && baseTotal > 0) {\n        toast({\n          title: \"Partner promotion removed\",\n          description: \"The selected partner promotion is no longer eligible for the current booking details.\"\n        });\n      }\n      setSelectedPartnerPromotionId(\"\");\n    }\n  }, [eligiblePartnerPromotions, selectedPartnerPromotionId, selectedPartnerPromotion, baseTotal, toast]);\n\n  useEffect(() => {\n    if (isPartnerBooking && eligiblePartnerPromotions.length > 0 && !selectedPartnerPromotionId) {\n      // Auto-select first eligible promotion when switching to partner mode\n      setSelectedPartnerPromotionId(eligiblePartnerPromotions[0].id.toString());\n      console.log('✅ Auto-selected promotion:', eligiblePartnerPromotions[0].title);\n    }\n  }, [isPartnerBooking, eligiblePartnerPromotions, selectedPartnerPromotionId]);\n\n  const fetchDynamicFields = async () => {\n    try {\n      const { data, error } = await (supabase as any)\n        .from('booking_fields_config')\n        .select('*')\n        .eq('is_active', true)\n        .contains('applies_to', ['room'])\n        .order('display_order', { ascending: true });\n\n      if (error) {\n        // Only log if error has meaningful information\n        // Suppress empty errors or schema-related errors (table might not exist)\n        const errorMessage = error?.message || error?.code || JSON.stringify(error);\n        if (errorMessage && errorMessage !== '{}' && !errorMessage.includes('relation') && !errorMessage.includes('does not exist')) {\n          console.error('Error fetching dynamic fields:', {\n            message: error.message,\n            code: error.code,\n            details: error.details,\n            hint: error.hint\n          });\n        }\n        // Don't show error to user, just log it - fields are optional\n        return;\n      }\n\n      setDynamicFields((data as any) || []);\n    } catch (error) {\n      // Only log unexpected errors, not expected ones (like missing table)\n      if (error instanceof Error) {\n        const errorMessage = error.message || '';\n        if (errorMessage && !errorMessage.includes('relation') && !errorMessage.includes('does not exist')) {\n          console.error('Error fetching dynamic fields:', error.message);\n        }\n      }\n    }\n  };\n\n  const fetchRoom = async () => {\n    if (!id) {\n      console.error('BookRoom: No room ID provided');\n      toast({\n        title: \"Error\",\n        description: \"No room ID provided\",\n        variant: \"destructive\",\n      });\n      setLoading(false);\n      return;\n    }\n\n    try {\n\n      setLoading(true);\n      \n      const roomIdNumber = parseInt(id);\n\n      \n      if (isNaN(roomIdNumber)) {\n        console.error('BookRoom: Invalid room ID format:', id);\n        toast({\n          title: \"Invalid Room ID\",\n          description: \"The room ID format is invalid\",\n          variant: \"destructive\",\n        });\n        setLoading(false);\n        return;\n      }\n      \n      const { data, error } = await supabase\n        .from('rooms')\n        .select('*')\n        .eq('id', roomIdNumber)\n        .maybeSingle();\n\n      console.log('BookRoom: Supabase query completed', { \n        data: data, \n        error: error,\n        hasData: !!data,\n        dataKeys: data ? Object.keys(data) : null\n      });\n      \n      if (error) {\n        console.error('BookRoom: Supabase error:', error);\n        toast({\n          title: \"Database Error\",\n          description: error.message || \"Failed to fetch room details\",\n          variant: \"destructive\",\n        });\n        setLoading(false);\n        return;\n      }\n      \n      if (!data) {\n        console.error('BookRoom: No room found for ID:', id);\n        toast({\n          title: \"Room Not Found\",\n          description: `Room with ID ${id} could not be found`,\n          variant: \"destructive\",\n        });\n        setLoading(false);\n        return;\n      }\n      \n      console.log('BookRoom: Successfully retrieved room data:', {\n        id: data.id,\n        name: data.name,\n        type: data.type,\n        price: data.price,\n        status: data.status\n      });\n      \n      setRoom(data);\n      \n    } catch (error: unknown) {\n      console.error('BookRoom: Unexpected error while fetching room:', error);\n      toast({\n        title: \"Error\",\n        description: \"An unexpected error occurred while loading the room\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const fetchActivePromotion = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('promotions')\n        .select('*')\n        .lte('start_date', new Date().toISOString().split('T')[0])\n        .gte('end_date', new Date().toISOString().split('T')[0])\n        .limit(1)\n        .maybeSingle();\n\n      if (error) throw error;\n      setActivePromotion(data);\n    } catch (error) {\n      console.log('BookRoom: No active promotion found or error fetching promotions');\n    }\n  };\n\n\n\n  const checkDateConflict = async (startDate: string, endDate: string) => {\n    if (!startDate || !endDate || !id) return;\n\n    try {\n      // First, update room statuses to ensure they reflect current booking expiration (9:30 AM)\n      await supabase.rpc('check_expired_bookings');\n\n      // Fetch all bookings for this room that might conflict\n      // We'll filter them client-side using the booking utility to account for 9:30 AM expiration\n      const { data: allBookings, error } = await supabase\n        .from('bookings')\n        .select('start_date, end_date, notes, status')\n        .eq('room_id', parseInt(id))\n        .in('status', ['booked', 'confirmed', 'pending_verification']);\n\n      if (error) throw error;\n\n      // Check for conflicts using the utility function that accounts for 9:30 AM expiration\n      const conflictingBookings = getConflictingBookings(startDate, endDate, allBookings || []);\n\n      if (conflictingBookings.length > 0) {\n        const conflictInfo = conflictingBookings.map(c => \n          `${c.start_date} to ${c.end_date}`\n        ).join(', ');\n        setDateConflict(`This room is already booked for: ${conflictInfo}`);\n        return true;\n      } else {\n        setDateConflict(null);\n        return false;\n      }\n    } catch (error) {\n      console.error('Error checking date conflicts:', error);\n      return false;\n    }\n  };\n\n  const calculateNights = () => nights;\n  const calculateBaseTotal = () => baseTotal;\n  const calculatePartnerDiscount = () => partnerDiscountAmount;\n  const calculateTotal = () => finalTotal;\n\n\n\n  const handleBookingSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (dateConflict) {\n      toast({\n        title: \"Cannot Create Booking\",\n        description: \"Please select different dates to avoid conflicts.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n\n    // Validate dynamic fields\n    const fieldErrors = validateDynamicFields(dynamicFields, dynamicFieldValues);\n    if (Object.keys(fieldErrors).length > 0) {\n      setDynamicFieldErrors(fieldErrors);\n      toast({\n        title: \"Validation Error\",\n        description: \"Please fill in all required fields correctly.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    setDynamicFieldErrors({});\n\n    // Enhanced authentication check\n    if (!user || !session) {\n      console.error('Booking submission failed - authentication required');\n      toast({\n        title: \"Authentication Required\",\n        description: \"Please log in again to continue with booking creation.\",\n        variant: \"destructive\",\n      });\n      navigate('/kabinda-lodge/client-auth');\n      return;\n    }\n\n    // Allow partner bookings without promotion (user can select \"No promotion\")\n    // Only validate if there's a promotion error (minimum amount not met, etc.)\n    if (isPartnerBooking && selectedPartnerPromotionId && !selectedPartnerPromotion) {\n      toast({\n        title: \"Invalid promotion\",\n        description: \"The selected promotion is no longer available. Please choose another or proceed without a promotion.\",\n        variant: \"destructive\"\n      });\n      return;\n    }\n\n    if (partnerPromotionError) {\n      toast({\n        title: \"Partner promotion not eligible\",\n        description: partnerPromotionError,\n        variant: \"destructive\"\n      });\n      return;\n    }\n\n    setSubmitting(true);\n\n    try {\n      console.log('Creating booking for user:', user.id);\n      const baseTotalAmount = calculateBaseTotal();\n      const partnerDiscount = calculatePartnerDiscount();\n      const totalPrice = Math.max(baseTotalAmount - partnerDiscount, 0);\n      const isPartnerPromotionApplied = Boolean(selectedPartnerPromotion && partnerDiscount > 0);\n      \n      // Build notes with company info if provided (for backward compatibility)\n      let notesWithCompany = formData.notes || '';\n      if (formData.guestCompany && formData.guestCompany.trim()) {\n        const companyNote = `Company: ${formData.guestCompany.trim()}`;\n        notesWithCompany = notesWithCompany \n          ? `${companyNote}\\n${notesWithCompany}` \n          : companyNote;\n      }\n\n      const bookingPayload: Record<string, unknown> = {\n        user_id: user.id,\n        room_id: parseInt(id!),\n        start_date: formData.startDate,\n        end_date: formData.endDate,\n        total_price: totalPrice,\n        guest_name: formData.guestName,\n        guest_email: formData.guestEmail,\n        guest_phone: formData.contactPhone,\n        guest_id_type: formData.idType,\n        guest_id_number: formData.idNumber,\n        notes: notesWithCompany || null,\n        status: 'pending_payment'\n      };\n\n      // Include guest_company if provided (requires database migration)\n      // Falls back to notes storage if column doesn't exist yet\n      if (formData.guestCompany && formData.guestCompany.trim()) {\n        bookingPayload.guest_company = formData.guestCompany.trim();\n      }\n\n      if (isPartnerPromotionApplied && selectedPartnerPromotion) {\n        bookingPayload.original_price = baseTotalAmount;\n        bookingPayload.discount_amount = partnerDiscount;\n        bookingPayload.promotion_id = selectedPartnerPromotion.id;\n      }\n      \n      // Create booking with native guest columns\n      let { data: booking, error: bookingError } = await (supabase as any)\n        .from('bookings')\n        .insert([bookingPayload])\n        .select()\n        .single();\n\n      if (bookingError) {\n        // Check if error object has any meaningful properties\n        const hasErrorProperties = bookingError && (\n          bookingError.message || \n          bookingError.error || \n          bookingError.code || \n          bookingError.details || \n          bookingError.hint ||\n          Object.keys(bookingError).length > 0\n        );\n        \n        // Extract error information safely\n        const errorMessage = bookingError?.message || bookingError?.error;\n        const errorCode = bookingError?.code;\n        const errorDetails = bookingError?.details;\n        const errorHint = bookingError?.hint;\n        \n        // Only log if we have meaningful error information\n        if (hasErrorProperties && errorMessage && \n            errorMessage !== '{}' && \n            errorMessage !== '[object Object]' &&\n            typeof errorMessage === 'string' &&\n            errorMessage.trim().length > 0) {\n          console.error('Booking creation error:', {\n            message: errorMessage,\n            code: errorCode,\n            details: errorDetails,\n            hint: errorHint\n          });\n          console.error('Booking payload was:', bookingPayload);\n        } else if (hasErrorProperties) {\n          // Log error object properties if available, even if message is missing\n          const errorInfo: Record<string, unknown> = {};\n          if (errorCode) errorInfo.code = errorCode;\n          if (errorDetails) errorInfo.details = errorDetails;\n          if (errorHint) errorInfo.hint = errorHint;\n          if (Object.keys(errorInfo).length > 0) {\n            console.error('Booking creation error (no message):', errorInfo);\n            console.error('Booking payload was:', bookingPayload);\n          }\n        }\n        // If error object is truly empty, don't log it to avoid console noise\n        \n        // If error is about missing columns (guest_company, promotion_id, etc.), retry without them\n        if (errorMessage && typeof errorMessage === 'string' && (\n          errorMessage.includes('guest_company') || \n          errorMessage.includes('promotion_id') || \n          errorMessage.includes('original_price') ||\n          errorMessage.includes('column') || \n          errorMessage.includes('schema cache')\n        )) {\n          console.warn('Some columns not found in database. Retrying without optional fields (company data stored in notes)');\n          \n          // Remove potentially missing columns\n          delete bookingPayload.guest_company;\n          delete bookingPayload.promotion_id;\n          delete bookingPayload.original_price;\n          delete bookingPayload.discount_amount;\n          \n          const { data: retryBooking, error: retryError } = await (supabase as any)\n            .from('bookings')\n            .insert([bookingPayload])\n            .select()\n            .single();\n          \n          if (retryError) {\n            console.error('Retry booking error:', retryError);\n            throw new Error(retryError.message || 'Failed to create booking after retry');\n          }\n          \n          // Success! Use the retry booking data and continue\n          console.log('Booking created successfully (without guest_company column):', retryBooking.id);\n          booking = retryBooking;\n        } else if (bookingError.message.includes('row-level security')) {\n          throw new Error('Permission denied. Please log in again and try again.');\n        } else if (bookingError.message.includes('foreign key')) {\n          throw new Error('Invalid room reference. Please refresh and try again.');\n        } else if (bookingError.message.includes('null value') || bookingError.message.includes('not-null')) {\n          throw new Error(`Missing required field: ${bookingError.message}`);\n        } else {\n          throw new Error(bookingError.message || 'Failed to create booking');\n        }\n      }\n\n      console.log('Booking created successfully:', booking.id);\n\n      // Save dynamic field values\n      if (dynamicFields.length > 0 && Object.keys(dynamicFieldValues).length > 0) {\n        const fieldValuesToInsert = dynamicFields\n          .filter(field => dynamicFieldValues[field.field_name] !== undefined && dynamicFieldValues[field.field_name] !== '')\n          .map(field => ({\n            booking_id: booking.id,\n            field_id: field.id,\n            field_value: String(dynamicFieldValues[field.field_name])\n          }));\n\n        if (fieldValuesToInsert.length > 0) {\n          const { error: fieldValuesError } = await (supabase as any)\n            .from('booking_field_values')\n            .insert(fieldValuesToInsert);\n\n          if (fieldValuesError) {\n            console.error('Error saving dynamic field values:', fieldValuesError);\n            // Don't fail the booking if field values fail to save, just log it\n          }\n        }\n      }\n\n      // Update room status\n      await supabase.rpc('check_expired_bookings');\n\n      setBookingId(booking.id);\n      setStep(2);\n      \n      toast({\n        title: \"Booking Created\",\n        description: \"Please proceed with payment to confirm your booking.\",\n      });\n      \n    } catch (error: unknown) {\n      console.error('Booking submission error:', error);\n      const errorMessage = error instanceof Error ? error.message : 'Failed to create booking';\n      \n      toast({\n        title: \"Booking Error\",\n        description: errorMessage,\n        variant: \"destructive\",\n      });\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  const handlePaymentSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setSubmitting(true);\n\n    try {\n      // Enhanced authentication check\n      if (!user || !session) {\n        console.error('Payment submission failed - authentication required');\n        toast({\n          title: \"Authentication Required\",\n          description: \"Please log in again to continue with payment submission.\",\n          variant: \"destructive\",\n        });\n        navigate('/kabinda-lodge/client-auth');\n        return;\n      }\n\n      // Validate payment method and transaction reference\n      if (!formData.paymentMethod) {\n        throw new Error('Please select a payment method');\n      }\n\n      if (formData.paymentMethod !== 'cash' && !formData.transactionRef) {\n        throw new Error('Transaction reference is required for mobile money payments');\n      }\n\n      // Verify booking exists; allow staff to process payments for any booking\n      console.log('Verifying booking exists for payment:', { bookingId, userId: user?.id, role: userRole });\n      const { data: booking, error: bookingVerifyError } = await supabase\n        .from('bookings')\n        .select('user_id, id, status')\n        .eq('id', bookingId)\n        .single();\n\n      if (bookingVerifyError) {\n        console.error('Payment validation error - booking verification failed:', bookingVerifyError);\n        throw new Error('Unable to verify booking details. Please try again.');\n      }\n\n      if (!booking) {\n        console.error('Payment validation error - booking not found:', bookingId);\n        throw new Error('Booking not found. Please contact support.');\n      }\n\n      const paymentStatus = (formData.paymentMethod === 'cash' && userRole === 'Receptionist') \n        ? 'verified' \n        : 'pending_verification';\n\n      console.log('Creating payment record:', {\n        booking_id: bookingId,\n        amount: calculateTotal(),\n        method: formData.paymentMethod,\n        status: paymentStatus,\n        user_id: user?.id,\n        session_id: session?.access_token ? 'present' : 'missing'\n      });\n\n      // Create payment with retry mechanism for RLS issues\n      let paymentError;\n      let retryCount = 0;\n      const maxRetries = 2;\n\n      // Use the payment method code directly from the database\n      const persistedMethod = formData.paymentMethod;\n\n      while (retryCount <= maxRetries) {\n        const { error } = await supabase\n          .from('payments')\n          .insert([\n            {\n              booking_id: bookingId,\n              amount: calculateTotal(),\n              method: persistedMethod,\n              transaction_ref: formData.paymentMethod === 'cash' \n                ? `CASH-${Date.now()}` \n                : formData.transactionRef,\n              status: paymentStatus\n            }\n          ]);\n\n        if (!error) {\n          paymentError = null;\n          break;\n        }\n\n        paymentError = error;\n        retryCount++;\n\n        if (retryCount <= maxRetries) {\n          console.warn(`Payment creation attempt ${retryCount} failed, retrying...`, error);\n          // Brief delay before retry\n          await new Promise(resolve => setTimeout(resolve, 500));\n        }\n      }\n\n      if (paymentError) {\n        console.error('Payment creation error after retries:', paymentError);\n        \n        // Provide specific error messages based on error type\n        if (paymentError.message.includes('row-level security') || paymentError.message.includes('permission denied')) {\n          throw new Error('Permission denied. Please refresh the page and try again.');\n        } else if (paymentError.message.includes('foreign key')) {\n          throw new Error('Invalid booking reference. Please refresh and try again.');\n        } else {\n          throw new Error(`Payment creation failed: ${paymentError.message}`);\n        }\n      }\n\n      console.log('Payment record created successfully');\n\n      // Update booking status based on payment method\n      const newBookingStatus = (formData.paymentMethod === 'cash' && userRole === 'Receptionist') \n        ? 'confirmed' \n        : 'pending_verification';\n        \n      console.log('Updating booking status:', { newBookingStatus, bookingId });\n      const { error: bookingUpdateError } = await supabase\n        .from('bookings')\n        .update({ status: newBookingStatus })\n        .eq('id', bookingId);\n      \n      if (bookingUpdateError) {\n        console.error('Booking status update error:', bookingUpdateError);\n        // Don't throw here since payment was already created\n        toast({\n          title: \"Payment Processed\",\n          description: \"Payment recorded but booking status update failed. Please contact reception.\",\n          variant: \"destructive\",\n        });\n      }\n\n      setStep(3);\n      \n      toast({\n        title: formData.paymentMethod === 'cash' && userRole === 'Receptionist' \n          ? \"Booking Confirmed\" \n          : \"Payment Submitted Successfully\",\n        description: formData.paymentMethod === 'cash' && userRole === 'Receptionist'\n          ? \"Cash payment confirmed. Booking is now active and guest can check in.\"\n          : \"Your payment information has been submitted successfully. Your booking is now pending verification and you'll receive confirmation within 2-4 hours.\",\n      });\n\n      if (formData.paymentMethod === 'cash' && userRole === 'Receptionist') {\n        setShowReceipt(true);\n      }\n    } catch (error: unknown) {\n      console.error('Payment submission error:', error);\n      \n      const errorMessage = error instanceof Error ? error.message : 'An unexpected error occurred while processing your payment';\n      \n      toast({\n        title: \"Payment Error\",\n        description: errorMessage,\n        variant: \"destructive\",\n      });\n    } finally {\n      setSubmitting(false);\n    }\n  };\n\n  if (authLoading || loading) {\n    return (\n      <div className=\"flex justify-center items-center min-h-screen\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4\"></div>\n          <p className=\"text-muted-foreground\">\n            {authLoading ? 'Authenticating...' : 'Loading room details...'}\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  if (!room) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-br from-background to-secondary/20 py-8\">\n        <div className=\"container max-w-4xl\">\n          <Card>\n            <CardContent className=\"flex items-center justify-center py-12\">\n              <div className=\"text-center\">\n                <h3 className=\"text-lg font-semibold mb-2\">Room Not Found</h3>\n                <p className=\"text-muted-foreground mb-4\">\n                  The room you're looking for could not be found or may no longer be available.\n                </p>\n                <div className=\"space-x-4\">\n                  <Button onClick={() => navigate('/kabinda-lodge/room-selection')}>\n                    Back to Room Selection\n                  </Button>\n                  <Button variant=\"outline\" onClick={() => navigate('/kabinda-lodge')}>\n                    Return Home\n                  </Button>\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-background to-secondary/20 py-8\">\n      <div className=\"container max-w-4xl\">\n        <div className=\"mb-8\">\n          <h1 className=\"text-3xl font-bold mb-2\">Book Your Stay</h1>\n          <div className=\"flex items-center gap-2\">\n            <Badge variant={step === 1 ? \"default\" : step > 1 ? \"secondary\" : \"outline\"}>\n              1. Booking Details\n            </Badge>\n            <Badge variant={step === 2 ? \"default\" : step > 2 ? \"secondary\" : \"outline\"}>\n              2. Payment\n            </Badge>\n            <Badge variant={step === 3 ? \"default\" : \"outline\"}>\n              3. Confirmation\n            </Badge>\n          </div>\n        </div>\n\n        <div className=\"grid lg:grid-cols-3 gap-8\">\n          {/* Room Summary */}\n          <div className=\"lg:col-span-1\">\n            <Card>\n              <CardHeader>\n                <CardTitle className=\"text-lg\">Room Summary</CardTitle>\n              </CardHeader>\n              <CardContent className=\"space-y-4\">\n                <div>\n                  <h3 className=\"font-semibold text-xl\">{room.name}</h3>\n                  <p className=\"text-muted-foreground\">{room.type}</p>\n                </div>\n                \n                <div className=\"flex items-center gap-2 text-sm text-muted-foreground\">\n                  <MapPin className=\"h-4 w-4\" />\n                  <span>{room.description}</span>\n                </div>\n\n                <div className=\"flex items-center justify-between pt-4 border-t\">\n                  <span className=\"font-semibold\">Price per night:</span>\n                  <span className=\"text-xl font-bold\">${room.price}</span>\n                </div>\n\n                {formData.startDate && formData.endDate && (\n                  <div className=\"space-y-2 pt-4 border-t\">\n                    <div className=\"flex justify-between\">\n                      <span>Nights:</span>\n                      <span>{calculateNights()}</span>\n                    </div>\n                    <div className=\"flex justify-between text-sm text-muted-foreground\">\n                      <span>Subtotal:</span>\n                      <span>${formatCurrency(baseTotal)}</span>\n                    </div>\n                    {partnerDiscountAmount > 0 && (\n                      <div className=\"flex justify-between text-sm text-green-600\">\n                        <span>Partner discount:</span>\n                        <span>- ${formatCurrency(partnerDiscountAmount)}</span>\n                      </div>\n                    )}\n                    <div className=\"flex justify-between font-semibold text-lg\">\n                      <span>Total:</span>\n                      <span>${formatCurrency(finalTotal)}</span>\n                    </div>\n                  </div>\n                )}\n              </CardContent>\n            </Card>\n          </div>\n\n          {/* Booking Form */}\n          <div className=\"lg:col-span-2\">\n            {step === 1 && (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <Calendar className=\"h-5 w-5\" />\n                    Booking Details\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <form onSubmit={handleBookingSubmit} className=\"space-y-6\">\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div>\n                        <Label htmlFor=\"startDate\">Check-in Date</Label>\n                         <Input\n                           type=\"date\"\n                           id=\"startDate\"\n                           value={formData.startDate}\n                           onChange={async (e) => {\n                             const newStartDate = e.target.value;\n                             setFormData({ ...formData, startDate: newStartDate });\n                             if (newStartDate && formData.endDate) {\n                               await checkDateConflict(newStartDate, formData.endDate);\n                             }\n                           }}\n                           required\n                           min={new Date().toISOString().split('T')[0]}\n                         />\n                       </div>\n                       <div>\n                         <Label htmlFor=\"endDate\">Check-out Date</Label>\n                         <Input\n                           type=\"date\"\n                           id=\"endDate\"\n                           value={formData.endDate}\n                           onChange={async (e) => {\n                             const newEndDate = e.target.value;\n                             setFormData({ ...formData, endDate: newEndDate });\n                             if (formData.startDate && newEndDate) {\n                               await checkDateConflict(formData.startDate, newEndDate);\n                             }\n                           }}\n                           required\n                           min={formData.startDate || new Date().toISOString().split('T')[0]}\n                         />\n                       </div>\n                     </div>\n\n                     {dateConflict && (\n                       <div className=\"p-4 bg-red-50 rounded-lg border border-red-200\">\n                         <p className=\"text-red-800 font-medium\">⚠️ Booking Conflict</p>\n                         <p className=\"text-sm text-red-700 mt-1\">{dateConflict}</p>\n                       </div>\n                     )}\n\n                     <div className=\"grid grid-cols-2 gap-4\">\n                       <div>\n                         <Label htmlFor=\"guestName\">Guest Name</Label>\n                         <Input\n                           type=\"text\"\n                           id=\"guestName\"\n                           value={formData.guestName}\n                           onChange={(e) => setFormData({ ...formData, guestName: e.target.value })}\n                           placeholder=\"Full name of the guest\"\n                           required\n                         />\n                       </div>\n                      <div>\n                        <Label htmlFor=\"guestEmail\">Guest Email (Optional)</Label>\n                        <Input\n                          type=\"text\"\n                          id=\"guestEmail\"\n                          value={formData.guestEmail}\n                          onChange={(e) => setFormData({ ...formData, guestEmail: e.target.value })}\n                          placeholder=\"guest@example.com (optional)\"\n                        />\n                      </div>\n                     </div>\n\n                     <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                      <div>\n                        <Label htmlFor=\"guestCompany\">Company/Organization (Optional)</Label>\n                        <Input\n                          type=\"text\"\n                          id=\"guestCompany\"\n                          value={formData.guestCompany}\n                          onChange={(e) => setFormData({ ...formData, guestCompany: e.target.value })}\n                          placeholder=\"Company or organization name\"\n                        />\n                      </div>\n                      <div>\n                       <Label htmlFor=\"guests\" className=\"flex items-center gap-2\">\n                         <Users className=\"h-4 w-4\" />\n                         Number of Guests\n                       </Label>\n                        <Input\n                         type=\"number\"\n                         id=\"guests\"\n                         min={1}\n                         max={6}\n                         value={formData.guests}\n                         onChange={(e) => setFormData({ ...formData, guests: parseInt(e.target.value) })}\n                         required\n                       />\n                      </div>\n                     </div>\n\n                    <div>\n                      <Label htmlFor=\"contactPhone\" className=\"flex items-center gap-2\">\n                        <Phone className=\"h-4 w-4\" />\n                        Contact Phone Number\n                      </Label>\n                      <Input\n                        type=\"tel\"\n                        id=\"contactPhone\"\n                        value={formData.contactPhone}\n                        onChange={(e) => setFormData({ ...formData, contactPhone: e.target.value })}\n                        placeholder=\"+243 xxx xxx xxx\"\n                        required\n                      />\n                    </div>\n\n                    <div className=\"grid grid-cols-2 gap-4\">\n                      <div>\n                        <Label htmlFor=\"idType\">ID Type</Label>\n                        <select\n                          id=\"idType\"\n                          className=\"w-full p-2 border rounded-lg\"\n                          value={formData.idType}\n                          onChange={(e) => setFormData({ ...formData, idType: e.target.value })}\n                          required\n                        >\n                          <option value=\"\">Select ID type</option>\n                          <option value=\"citizen_id\">Citizen ID</option>\n                          <option value=\"passport\">Passport Number</option>\n                          <option value=\"driving_license\">Driving License Number</option>\n                        </select>\n                      </div>\n                      <div>\n                        <Label htmlFor=\"idNumber\">ID Number</Label>\n                        <Input\n                          type=\"text\"\n                          id=\"idNumber\"\n                          value={formData.idNumber}\n                          onChange={(e) => setFormData({ ...formData, idNumber: e.target.value })}\n                          placeholder=\"Enter ID number\"\n                          required\n                        />\n                      </div>\n                    </div>\n\n                    <div>\n                      <Label htmlFor=\"notes\">Special Requests (Optional)</Label>\n                      <Textarea\n                        id=\"notes\"\n                        value={formData.notes}\n                        onChange={(e) => setFormData({ ...formData, notes: e.target.value })}\n                        placeholder=\"Any special requests or notes...\"\n                        rows={3}\n                      />\n                    </div>\n\n                    <div className=\"pt-4 border-t space-y-4\">\n                      <div>\n                        <Label>Booking Type</Label>\n                        <div role=\"radiogroup\" aria-label=\"Booking Type\" className=\"mt-3 grid gap-4 sm:grid-cols-2\">\n                          <button\n                            type=\"button\"\n                            role=\"radio\"\n                            aria-checked={!isPartnerBooking}\n                            onClick={() => handleBookingTypeSelect(\"standard\")}\n                            className={`flex flex-col gap-2 rounded-xl border border-border bg-background p-4 text-left transition-all hover:border-primary hover:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 ${\n                              !isPartnerBooking ? \"border-primary bg-primary/5 shadow-sm\" : \"\"\n                            }`}\n                          >\n                            <span className=\"text-base font-semibold\">Standard Guest</span>\n                            <span className=\"text-sm text-muted-foreground\">\n                              Book directly with Kabinda Lodge at public rates with full flexibility.\n                            </span>\n                          </button>\n                          <button\n                            type=\"button\"\n                            role=\"radio\"\n                            aria-checked={isPartnerBooking}\n                            onClick={() => handleBookingTypeSelect(\"partner\")}\n                            className={`flex flex-col gap-2 rounded-xl border border-border bg-background p-4 text-left transition-all hover:border-primary hover:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 ${\n                              isPartnerBooking ? \"border-primary bg-primary/5 shadow-sm\" : \"\"\n                            }`}\n                          >\n                            <span className=\"text-base font-semibold\">Partner Client</span>\n                            <span className=\"text-sm text-muted-foreground\">\n                              Use your corporate or partner benefits and apply exclusive promotions.\n                            </span>\n                            {partnerPromotionsLoading && isPartnerBooking && (\n                              <span className=\"text-xs text-muted-foreground\">Loading partner offers…</span>\n                            )}\n                          </button>\n                        </div>\n                      </div>\n\n                      {isPartnerBooking && (\n                        <div className=\"space-y-3\">\n                          <div>\n                            <Label htmlFor=\"partnerPromotion\">Partner Promotion</Label>\n                          {partnerPromotionsLoading ? (\n                            <div className=\"mt-2 w-full rounded-lg border p-3 text-sm text-muted-foreground\">\n                              Loading partner promotions...\n                            </div>\n                          ) : (\n                            <div className=\"mt-2 space-y-3\">\n                              {eligiblePartnerPromotions.length === 0 ? (\n                                <div className=\"rounded-lg border border-dashed p-4 text-sm text-muted-foreground\">\n                                  <div className=\"flex items-center gap-2\">\n                                    <Gift className=\"h-4 w-4\" />\n                                    <span>No partner promotions currently match this stay.</span>\n                                  </div>\n                                  <p className=\"mt-1 text-xs\">\n                                    {hasBookingAmount\n                                      ? \"Adjust stay details or check back later for partner offers.\"\n                                      : \"Select stay dates to view available partner promotions.\"}\n                                  </p>\n                                </div>\n                              ) : (\n                                <div className=\"grid gap-3\">\n                                  {eligiblePartnerPromotions.map((promotion) => {\n                                    const isSelected = selectedPartnerPromotionId === promotion.id.toString();\n                                    const isFixed = promotion.discount_type === \"fixed\";\n                                    const discountLabel = isFixed\n                                      ? `Save $${formatCurrency(Number(promotion.discount_amount || 0))}`\n                                      : `${promotion.discount_percent}% off`;\n\n                                    return (\n                                      <button\n                                        key={promotion.id}\n                                        type=\"button\"\n                                        onClick={() => handlePartnerPromotionSelect(promotion.id.toString())}\n                                        className={`flex flex-col gap-2 rounded-xl border p-4 text-left transition-all hover:border-primary hover:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary focus-visible:ring-offset-2 ${\n                                          isSelected ? \"border-primary bg-primary/5 shadow-sm\" : \"border-border bg-background\"\n                                        }`}\n                                      >\n                                        <div className=\"flex items-center justify-between\">\n                                          <span className=\"text-sm font-semibold\">{promotion.title}</span>\n                                          <Badge variant={isSelected ? \"default\" : \"secondary\"} className=\"flex items-center gap-1\">\n                                            <Tag className=\"h-3 w-3\" />\n                                            {discountLabel}\n                                          </Badge>\n                                        </div>\n                                        {promotion.partner_name && (\n                                          <span className=\"text-xs text-muted-foreground\">\n                                            Partner: {promotion.partner_name}\n                                          </span>\n                                        )}\n                                        {promotion.description && (\n                                          <p className=\"text-xs text-muted-foreground\">{promotion.description}</p>\n                                        )}\n                                      </button>\n                                    );\n                                  })}\n                                </div>\n                              )}\n                            </div>\n                          )}\n                          </div>\n\n                          {partnerPromotionError && (\n                            <p className=\"text-sm text-red-600\">{partnerPromotionError}</p>\n                          )}\n\n                          {!partnerPromotionsLoading && eligiblePartnerPromotions.length === 0 && (\n                            <p className=\"text-sm text-muted-foreground\">\n                              {hasBookingAmount\n                                ? \"No partner promotions are currently available for the selected stay.\"\n                                : \"Select your stay dates to view available partner promotions.\"}\n                            </p>\n                          )}\n                        </div>\n                      )}\n                    </div>\n\n                    {/* Dynamic Fields */}\n                    {dynamicFields.length > 0 && (\n                      <div className=\"space-y-4 pt-4 border-t\">\n                        <h3 className=\"font-semibold text-lg\">Additional Information</h3>\n                        {dynamicFields.map((field) => (\n                          <div key={field.id}>\n                            {renderDynamicField(\n                              field,\n                              dynamicFieldValues[field.field_name] || '',\n                              (value) => {\n                                setDynamicFieldValues(prev => ({\n                                  ...prev,\n                                  [field.field_name]: value\n                                }));\n                                // Clear error when user starts typing\n                                if (dynamicFieldErrors[field.field_name]) {\n                                  setDynamicFieldErrors(prev => {\n                                    const newErrors = { ...prev };\n                                    delete newErrors[field.field_name];\n                                    return newErrors;\n                                  });\n                                }\n                              },\n                              dynamicFieldErrors[field.field_name]\n                            )}\n                          </div>\n                        ))}\n                      </div>\n                    )}\n\n                    <Button type=\"submit\" className=\"w-full\" disabled={disableBookingSubmit}>\n                      {submitting ? \"Creating Booking...\" : \"Continue to Payment\"}\n                    </Button>\n                  </form>\n                </CardContent>\n              </Card>\n            )}\n\n            {step === 2 && (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2\">\n                    <CreditCard className=\"h-5 w-5\" />\n                    Payment Instructions\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-6\">\n                  <div className=\"rounded-lg border border-blue-200 bg-blue-50 p-4 space-y-3\">\n                    <div>\n                      <h3 className=\"font-semibold text-blue-900\">\n                        Amount Due: ${formatCurrency(finalTotal)}\n                      </h3>\n                      <p className=\"text-blue-800 text-sm\">\n                        {paymentMethods.length > 0 \n                          ? 'Please use one of the available payment methods below to complete your payment.'\n                          : 'Please contact reception for payment instructions.'}\n                      </p>\n                    </div>\n                    <div className=\"rounded-md border border-blue-100 bg-white p-3 space-y-1 text-sm\">\n                      <div className=\"flex justify-between text-muted-foreground\">\n                        <span>Subtotal</span>\n                        <span>${formatCurrency(baseTotal)}</span>\n                      </div>\n                      {partnerDiscountAmount > 0 && (\n                        <div className=\"flex justify-between text-green-600\">\n                          <span>Partner discount</span>\n                          <span>- ${formatCurrency(partnerDiscountAmount)}</span>\n                        </div>\n                      )}\n                      <div className=\"flex justify-between font-semibold text-blue-900\">\n                        <span>Amount to pay</span>\n                        <span>${formatCurrency(finalTotal)}</span>\n                      </div>\n                    </div>\n                  </div>\n\n                  {selectedPartnerPromotion && partnerDiscountAmount > 0 && (\n                    <div className=\"rounded-lg border border-green-200 bg-green-50 p-4\">\n                      <div className=\"flex items-center gap-2 text-green-800 font-semibold\">\n                        <Tag className=\"h-4 w-4\" />\n                        <span>{selectedPartnerPromotion.title} applied</span>\n                      </div>\n                      <p className=\"mt-1 text-sm text-green-700\">\n                        Partner savings: ${formatCurrency(partnerDiscountAmount)} off the original ${formatCurrency(baseTotal)}\n                      </p>\n                    </div>\n                  )}\n\n                  <div className=\"p-4 border rounded-lg bg-blue-50 border-blue-200\">\n                    <p className=\"text-blue-900 font-medium mb-2\">Payment Instructions</p>\n                    <p className=\"text-sm text-blue-800\">\n                      Please contact our reception staff for available payment methods and instructions.\n                    </p>\n                    <p className=\"text-sm text-blue-700 mt-2\">\n                      Your booking reference: <span className=\"font-mono font-semibold\">HOTEL-{bookingId}</span>\n                    </p>\n                  </div>\n\n                  <form onSubmit={handlePaymentSubmit} className=\"space-y-4 pt-6 border-t\">\n                    <div>\n                      <Label htmlFor=\"paymentMethod\">Payment Method Used</Label>\n                      {paymentMethodsLoading ? (\n                        <div className=\"w-full p-2 border rounded-lg text-muted-foreground\">\n                          Loading payment methods...\n                        </div>\n                      ) : (\n                        <select\n                          id=\"paymentMethod\"\n                          className=\"w-full p-2 border rounded-lg\"\n                          value={formData.paymentMethod}\n                          onChange={(e) => setFormData({ ...formData, paymentMethod: e.target.value })}\n                          required\n                        >\n                          <option value=\"\">Select payment method</option>\n                          {paymentMethods.map((method) => (\n                            <option key={method.id} value={method.code}>\n                              {method.name}\n                            </option>\n                          ))}\n                        </select>\n                      )}\n                    </div>\n\n                    {formData.paymentMethod && formData.paymentMethod !== 'cash' && (\n                      <div>\n                        <Label htmlFor=\"transactionRef\">Transaction Reference Number</Label>\n                        <Input\n                          type=\"text\"\n                          id=\"transactionRef\"\n                          value={formData.transactionRef}\n                          onChange={(e) => setFormData({ ...formData, transactionRef: e.target.value })}\n                          placeholder=\"Enter the transaction ID/reference from your mobile money\"\n                          required\n                        />\n                        <p className=\"text-sm text-muted-foreground mt-1\">\n                          This is the confirmation code you received after sending the money\n                        </p>\n                      </div>\n                    )}\n\n                    {formData.paymentMethod === 'cash' && userRole === 'Receptionist' && (\n                      <div className=\"p-4 bg-green-50 rounded-lg border border-green-200\">\n                        <p className=\"text-green-800 font-medium\">\n                          💵 Cash Payment Selected\n                        </p>\n                        <p className=\"text-sm text-green-700 mt-1\">\n                          This payment will be marked as completed immediately upon submission.\n                        </p>\n                      </div>\n                    )}\n\n                    <Button type=\"submit\" className=\"w-full\" disabled={submitting}>\n                      {submitting ? \"Processing...\" : \n                       formData.paymentMethod === 'cash' && userRole === 'Receptionist' \n                         ? \"Complete Cash Payment\" \n                         : \"Submit Payment Information\"}\n                    </Button>\n                  </form>\n                </CardContent>\n              </Card>\n            )}\n\n            {step === 3 && (\n              <Card>\n                <CardHeader>\n                  <CardTitle className=\"flex items-center gap-2 text-green-600\">\n                    <CheckCircle className=\"h-5 w-5\" />\n                    Booking Submitted Successfully!\n                  </CardTitle>\n                </CardHeader>\n                <CardContent className=\"space-y-4\">\n                   <div className=\"p-4 bg-green-50 rounded-lg border border-green-200\">\n                     <h3 className=\"font-semibold text-green-900 mb-2\">\n                       {formData.paymentMethod === 'cash' && userRole === 'Receptionist' \n                         ? \"Cash Payment Completed!\" \n                         : \"What happens next?\"}\n                     </h3>\n                     {formData.paymentMethod === 'cash' && userRole === 'Receptionist' ? (\n                       <ul className=\"text-green-800 text-sm space-y-1\">\n                         <li>• Cash payment has been processed and confirmed</li>\n                         <li>• Your booking is now active and confirmed</li>\n                         <li>• Guest can proceed to their room</li>\n                         <li>• Your booking reference is: <span className=\"font-mono font-semibold\">HOTEL-{bookingId}</span></li>\n                       </ul>\n                     ) : (\n                       <ul className=\"text-green-800 text-sm space-y-1\">\n                         <li>• Our team will verify your payment within 2-4 hours</li>\n                         <li>• You'll receive a confirmation email once verified</li>\n                         <li>• Your booking reference is: <span className=\"font-mono font-semibold\">HOTEL-{bookingId}</span></li>\n                       </ul>\n                     )}\n                  </div>\n\n                   <div className=\"space-y-2\">\n                     {formData.paymentMethod === 'cash' && userRole === 'Receptionist' ? (\n                       <p className=\"text-sm text-muted-foreground\">\n                         <strong>Cash Payment Confirmed:</strong> The booking is now active and ready for guest check-in.\n                       </p>\n                     ) : (\n                       <>\n                         <p className=\"text-sm text-muted-foreground\">\n                           <strong>Important:</strong> Please keep your transaction reference number safe. \n                           You may need it if there are any issues with payment verification.\n                         </p>\n                         <p className=\"text-sm text-muted-foreground\">\n                           If you don't receive confirmation within 4 hours, please contact us with your booking reference.\n                         </p>\n                       </>\n                     )}\n                  </div>\n\n                   {selectedPartnerPromotion && partnerDiscountAmount > 0 && (\n                     <div className=\"rounded-lg border border-green-200 bg-green-50 p-4 space-y-1\">\n                       <div className=\"flex items-center gap-2 text-green-800 font-semibold\">\n                         <Tag className=\"h-4 w-4\" />\n                         <span>Partner promotion applied</span>\n                       </div>\n                       <p className=\"text-sm text-green-700\">{selectedPartnerPromotion.title}</p>\n                       <p className=\"text-sm text-green-700\">\n                         You saved ${formatCurrency(partnerDiscountAmount)} on this booking.\n                       </p>\n                     </div>\n                   )}\n\n                    <div className=\"flex gap-3 pt-4\">\n                      {formData.paymentMethod === 'cash' && userRole === 'Receptionist' && (\n                        <Button onClick={() => setShowReceipt(true)} className=\"flex-1\">\n                          Generate Receipt\n                        </Button>\n                      )}\n                      {(userRole === 'Receptionist' || userRole === 'Admin') && (\n                        <Button onClick={() => navigate('/kabinda-lodge/room-selection')} className=\"flex-1\">\n                          New Booking\n                        </Button>\n                      )}\n                     <Button onClick={() => navigate('/kabinda-lodge')}>\n                       Return Home\n                     </Button>\n                   </div>\n                </CardContent>\n              </Card>\n            )}\n           </div>\n         </div>\n       </div>\n\n       {showReceipt && room && bookingId && (\n         <ReceiptGenerator\n            receiptData={{\n              bookingId,\n              guestName: formData.guestName,\n              guestEmail: formData.guestEmail,\n              guestPhone: formData.contactPhone,\n             roomName: room.name,\n             roomType: room.type,\n             checkIn: formData.startDate,\n             checkOut: formData.endDate,\n             nights: calculateNights(),\n             roomPrice: room.price,\n             totalAmount: calculateTotal(),\n             paymentMethod: formData.paymentMethod,\n             transactionRef: formData.transactionRef,\n             promotion: receiptPromotion,\n             createdAt: new Date().toISOString()\n           }}\n           onClose={() => setShowReceipt(false)}\n         />\n       )}\n    </div>\n  );\n};\n\nexport default BookRoom;\n"],"names":[],"mappings":"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"}}]
}